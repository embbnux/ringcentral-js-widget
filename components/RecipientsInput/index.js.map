{"version":3,"sources":["components/RecipientsInput/index.js"],"names":["SelectedRecipientItem","props","className","phoneNumber","length","blue","name","removeReceiver","onRemove","propTypes","string","isRequired","func","SelectedRecipients","items","selectReceivers","map","item","removeFromRecipients","PropTypes","arrayOf","shape","RecipientsInput","state","isFocusOnInput","selectedContactIndex","onReceiversInputFocus","setState","onReceiversInputBlur","setSelectedIndex","index","addSelectedContactIndex","searchContactList","preState","reduceSelectedContactIndex","handleHotKey","e","value","key","preventDefault","relatedContactList","slice","currentSelected","addToRecipients","onClean","label","container","rightPanel","recipients","inputField","onChange","onKeyUp","onKeyDown","numberInput","placeholder","removeButton","formatContactPhone","contactsDropdown","entityType","phoneType","defaultProps"],"mappings":"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","file":"index.js","sourcesContent":["import React, { PropTypes, Component } from 'react';\nimport styles from './styles.scss';\nimport RemoveButton from '../RemoveButton';\nimport ContactDropdownList from '../ContactDropdownList';\n\nfunction SelectedRecipientItem(props) {\n  const className = props.phoneNumber.length > 5 ? styles.blue : null;\n  return (\n    <li className={className}>\n      <span>{props.name}</span>\n      <RemoveButton\n        className={styles.removeReceiver}\n        onClick={props.onRemove}\n        visibility\n      />\n    </li>\n  );\n}\n\nSelectedRecipientItem.propTypes = {\n  name: PropTypes.string.isRequired,\n  phoneNumber: PropTypes.string.isRequired,\n  onRemove: PropTypes.func.isRequired,\n};\n\nfunction SelectedRecipients(props) {\n  const items = props.items;\n  if (items.length < 1) {\n    return null;\n  }\n  return (\n    <ul className={styles.selectReceivers}>\n      {\n        items.map(item => (\n          <SelectedRecipientItem\n            key={item.phoneNumber}\n            name={item.name}\n            phoneNumber={item.phoneNumber}\n            onRemove={() => props.removeFromRecipients(item.phoneNumber)}\n          />\n        ))\n      }\n    </ul>\n  );\n}\n\nSelectedRecipients.propTypes = {\n  removeFromRecipients: PropTypes.func.isRequired,\n  items: React.PropTypes.arrayOf(PropTypes.shape({\n    phoneNumber: PropTypes.string.isRequired,\n    name: PropTypes.string.isRequired,\n  })).isRequired,\n};\n\nclass RecipientsInput extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isFocusOnInput: false,\n      selectedContactIndex: 0,\n    };\n\n    this.onReceiversInputFocus = () => {\n      this.setState({\n        isFocusOnInput: true,\n        selectedContactIndex: 0,\n      });\n    };\n\n    this.onReceiversInputBlur = () => {\n      this.setState({\n        isFocusOnInput: false,\n        selectedContactIndex: -1,\n      });\n    };\n\n    this.setSelectedIndex = (index) => {\n      this.setState({\n        selectedContactIndex: index,\n      });\n    };\n\n    this.addSelectedContactIndex = () => {\n      const length = this.props.searchContactList.length < 5 ?\n                      this.props.searchContactList.length : 5;\n      if (this.state.selectedContactIndex >= (length - 1)) {\n        this.setState({\n          selectedContactIndex: 0,\n        });\n      } else {\n        this.setState(preState => ({\n          selectedContactIndex: (preState.selectedContactIndex + 1),\n        }));\n      }\n    };\n\n    this.reduceSelectedContactIndex = () => {\n      const length = this.props.searchContactList.length < 5 ?\n                      this.props.searchContactList.length : 5;\n      if (this.state.selectedContactIndex > 0) {\n        this.setState(preState => ({\n          selectedContactIndex: (preState.selectedContactIndex - 1),\n        }));\n      } else {\n        this.setState({\n          selectedContactIndex: (length - 1),\n        });\n      }\n    };\n\n    this.handleHotKey = (e) => {\n      if (this.state.isFocusOnInput && this.props.value.length >= 3) {\n        if (e.key === 'ArrowUp') {\n          this.reduceSelectedContactIndex();\n        } else if (e.key === 'ArrowDown') {\n          this.addSelectedContactIndex();\n        }\n      } else {\n        this.setState({\n          selectedContactIndex: 0,\n        });\n      }\n      if (e.key === ',' || e.key === ';' || e.key === 'Enter') {\n        e.preventDefault();\n        if (this.props.value.length === 0) {\n          return;\n        }\n        let relatedContactList = this.props.value.length >= 3 ?\n          this.props.searchContactList : [];\n        // MAX 5\n        if (relatedContactList.length > 5) {\n          relatedContactList = relatedContactList.slice(0, 5);\n        }\n        const currentSelected\n          = relatedContactList[this.state.selectedContactIndex];\n        if (currentSelected) {\n          this.props.addToRecipients({\n            name: currentSelected.name,\n            phoneNumber: currentSelected.phoneNumber,\n          });\n        } else {\n          this.props.addToRecipients({\n            name: this.props.value,\n            phoneNumber: this.props.value,\n          });\n          this.props.onClean();\n        }\n        this.props.onClean();\n      }\n    };\n  }\n\n  render() {\n    let relatedContactList = this.props.value.length >= 3 ?\n      this.props.searchContactList : [];\n    const label = this.props.label ?\n      (\n        <label>{this.props.label}</label>\n      ) : null;\n    // MAX 5\n    if (relatedContactList.length > 5) {\n      relatedContactList = relatedContactList.slice(0, 5);\n    }\n\n    return (\n      <div className={styles.container} onKeyDown={this.handleHotKey}>\n        {label}\n        <div className={styles.rightPanel}>\n          <SelectedRecipients\n            items={this.props.recipients}\n            removeFromRecipients={this.props.removeFromRecipients}\n          />\n          <div className={styles.inputField}>\n            <input\n              name=\"receiver\"\n              value={this.props.value}\n              onChange={this.props.onChange}\n              onKeyUp={this.props.onKeyUp}\n              onKeyDown={this.props.onKeyDown}\n              className={styles.numberInput}\n              maxLength={30}\n              onFocus={this.onReceiversInputFocus}\n              onBlur={this.onReceiversInputBlur}\n              placeholder={this.props.placeholder}\n              autoComplete=\"off\"\n            />\n          </div>\n          <RemoveButton\n            className={styles.removeButton}\n            onClick={this.props.onClean}\n            visibility={\n              this.props.value.length > 0 &&\n              this.state.isFocusOnInput\n            }\n          />\n        </div>\n        <ContactDropdownList\n          selectedIndex={this.state.selectedContactIndex}\n          setSelectedIndex={this.setSelectedIndex}\n          addToRecipients={this.props.addToRecipients}\n          items={relatedContactList}\n          formatContactPhone={this.props.formatContactPhone}\n          className={styles.contactsDropdown}\n          visibility={this.state.isFocusOnInput}\n        />\n      </div>\n    );\n  }\n}\n\nRecipientsInput.propTypes = {\n  label: PropTypes.string,\n  placeholder: PropTypes.string,\n  searchContactList: PropTypes.arrayOf(PropTypes.shape({\n    name: PropTypes.string.isRequired,\n    entityType: PropTypes.string.isRequired,\n    phoneType: PropTypes.string.isRequired,\n    phoneNumber: PropTypes.string.isRequired,\n  })).isRequired,\n  recipients: PropTypes.arrayOf(PropTypes.shape({\n    phoneNumber: PropTypes.string.isRequired,\n    name: PropTypes.string.isRequired,\n  })).isRequired,\n  value: PropTypes.string.isRequired,\n  onChange: PropTypes.func.isRequired,\n  onClean: PropTypes.func.isRequired,\n  onKeyUp: PropTypes.func,\n  onKeyDown: PropTypes.func,\n  addToRecipients: PropTypes.func.isRequired,\n  removeFromRecipients: PropTypes.func.isRequired,\n  formatContactPhone: PropTypes.func.isRequired,\n};\n\nRecipientsInput.defaultProps = {\n  label: null,\n  placeholder: '',\n  onKeyUp: () => null,\n  onKeyDown: () => null,\n};\n\nexport default RecipientsInput;\n"]}