{"version":3,"sources":["components/Draggable/index.js"],"names":["Draggable","props","state","dragging","positionX","positionY","translateX","positionOffsetX","translateY","positionOffsetY","_isClick","_onMouseDown","e","button","setState","clientX","clientY","_positionXOnMouseDown","_positionYOnMouseDown","window","addEventListener","_onMouseMove","_onMouseUp","stopPropagation","preventDefault","draggableDom","offsetParent","originalPositionX","offsetLeft","originalPositionY","offsetTop","newPositionX","newPositionY","child","firstChild","height","clientHeight","width","clientWidth","Math","abs","clickThreshold","preState","newState","updatePositionOffset","removeEventListener","_onClick","onClick","className","children","style","msTransition","WebkitTransition","transform","styles","root","Component","propTypes","PropTypes","string","node","isRequired","func","number","defaultProps"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;AACA;;;;AACA;;;;AAEA;;;;;;AACA;;IAEMA,S;;;AACJ,qBAAYC,KAAZ,EAAmB;AAAA;;AAAA,4IACXA,KADW;;AAGjB,UAAKC,KAAL,GAAa;AACXC,gBAAU,KADC;AAEXC,iBAAW,CAFA;AAGXC,iBAAW,CAHA;AAIXC,kBAAYL,MAAMM,eAJP;AAKXC,kBAAYP,MAAMQ;AALP,KAAb;;AAQA,UAAKC,QAAL,GAAgB,IAAhB;AACA,UAAKC,YAAL,GAAoB,UAACC,CAAD,EAAO;AACzB,UAAIA,EAAEC,MAAF,KAAa,CAAjB,EAAoB;AACpB,UAAI,MAAKX,KAAL,CAAWC,QAAf,EAAyB;AACvB;AACD;AACD,YAAKW,QAAL,CAAc;AACZV,mBAAWQ,EAAEG,OADD;AAEZV,mBAAWO,EAAEI,OAFD;AAGZb,kBAAU;AAHE,OAAd;AAKA,YAAKc,qBAAL,GAA6BL,EAAEG,OAA/B;AACA,YAAKG,qBAAL,GAA6BN,EAAEI,OAA/B;AACA,YAAKN,QAAL,GAAgB,IAAhB;AACAS,aAAOC,gBAAP,CAAwB,WAAxB,EAAqC,MAAKC,YAA1C,EAAwD,KAAxD;AACAF,aAAOC,gBAAP,CAAwB,SAAxB,EAAmC,MAAKE,UAAxC,EAAoD,KAApD;AACAV,QAAEW,eAAF;AACAX,QAAEY,cAAF;AACD,KAjBD;;AAmBA,UAAKH,YAAL,GAAoB,UAACT,CAAD,EAAO;AACzB,UAAI,CAAC,MAAKV,KAAL,CAAWC,QAAhB,EAA0B;AACxB;AACD;AACD,UAAI,CAAC,MAAKsB,YAAV,EAAwB;AACtB;AACD;AANwB,+BAWrB,MAAKA,YAXgB;AAAA,UAQvBC,YARuB,sBAQvBA,YARuB;AAAA,UASXC,iBATW,sBASvBC,UATuB;AAAA,UAUZC,iBAVY,sBAUvBC,SAVuB;;AAYzB,UAAMC,eAAenB,EAAEG,OAAvB;AACA,UAAMiB,eAAepB,EAAEI,OAAvB;AACA,UAAMiB,QAAQ,MAAKR,YAAL,CAAkBS,UAAhC;AACA,UAAMC,SAAUF,SAASA,MAAMG,YAAhB,IAAiC,CAAhD;AACA,UAAMC,QAASJ,SAASA,MAAMK,WAAhB,IAAgC,CAA9C;AACA,UACEC,KAAKC,GAAL,CAAST,eAAe,MAAKd,qBAA7B,IAAsD,MAAKhB,KAAL,CAAWwC,cAAjE,IACAF,KAAKC,GAAL,CAASR,eAAe,MAAKd,qBAA7B,IAAsD,MAAKjB,KAAL,CAAWwC,cAFnE,EAGE;AACA,cAAK/B,QAAL,GAAgB,KAAhB;AACD;AACD,YAAKI,QAAL,CAAc,UAAC4B,QAAD,EAAc;AAC1B,YAAMC,WAAW;AACfvC,qBAAW2B,YADI;AAEf1B,qBAAW2B,YAFI;AAGf1B,sBAAYoC,SAASpC,UAAT,IAAuByB,eAAeW,SAAStC,SAA/C,CAHG;AAIfI,sBAAYkC,SAASlC,UAAT,IAAuBwB,eAAeU,SAASrC,SAA/C;AAJG,SAAjB;AAMA,YACGsB,oBAAoB,EAArB,GAA2BgB,SAASrC,UAApC,GAAiDoB,aAAaY,WAA9D,IACCX,oBAAoB,EAArB,GAA2BgB,SAASrC,UAApC,GAAiD+B,KAFnD,EAGE;AACA,iBAAOM,SAASrC,UAAhB;AACD;AACD,YACGuB,oBAAoB,EAArB,GAA2Bc,SAASnC,UAApC,GAAiDkB,aAAaU,YAAb,GAA4BD,MAA7E,IACCN,oBAAoB,EAArB,GAA2Bc,SAASnC,UAApC,GAAiD,CAFnD,EAGE;AACA,iBAAOmC,SAASnC,UAAhB;AACD;AACD,eAAOmC,QAAP;AACD,OApBD;AAqBA/B,QAAEW,eAAF;AACAX,QAAEY,cAAF;AACD,KA9CD;;AAgDA,UAAKF,UAAL,GAAkB,UAACV,CAAD,EAAO;AACvB,YAAKE,QAAL,CAAc;AACZX,kBAAU;AADE,OAAd;AAGA,YAAKF,KAAL,CAAW2C,oBAAX,CAAgC,MAAK1C,KAAL,CAAWI,UAA3C,EAAuD,MAAKJ,KAAL,CAAWM,UAAlE;AACAW,aAAO0B,mBAAP,CAA2B,WAA3B,EAAwC,MAAKxB,YAA7C;AACAF,aAAO0B,mBAAP,CAA2B,SAA3B,EAAsC,MAAKvB,UAA3C;AACAV,QAAEW,eAAF;AACAX,QAAEY,cAAF;AACD,KATD;;AAWA,UAAKsB,QAAL,GAAgB,UAAClC,CAAD,EAAO;AACrB,UAAI,CAAC,MAAKF,QAAV,EAAoB;AAClB;AACD;AACD,YAAKT,KAAL,CAAW8C,OAAX,CAAmBnC,CAAnB;AACD,KALD;AA1FiB;AAgGlB;;;;2CAEsB;AACrBO,aAAO0B,mBAAP,CAA2B,WAA3B,EAAwC,KAAKxB,YAA7C;AACAF,aAAO0B,mBAAP,CAA2B,SAA3B,EAAsC,KAAKvB,UAA3C;AACD;;;6BAEQ;AAAA;;AAAA,mBAIH,KAAKrB,KAJF;AAAA,UAEL+C,SAFK,UAELA,SAFK;AAAA,UAGLC,QAHK,UAGLA,QAHK;;AAKP,UAAMC,QAAQ;AACZC,qCAA2B,KAAKjD,KAAL,CAAWI,UAAtC,YAAuD,KAAKJ,KAAL,CAAWM,UAAlE,QADY;AAEZ4C,yCAA+B,KAAKlD,KAAL,CAAWI,UAA1C,YAA2D,KAAKJ,KAAL,CAAWM,UAAtE,QAFY;AAGZ6C,kCAAwB,KAAKnD,KAAL,CAAWI,UAAnC,YAAoD,KAAKJ,KAAL,CAAWM,UAA/D;AAHY,OAAd;AAKA,aACE;AAAA;AAAA;AACE,uBAAa,KAAKG,YADpB;AAEE,eAAK,aAACc,YAAD,EAAkB;AAAE,mBAAKA,YAAL,GAAoBA,YAApB;AAAmC,WAF9D;AAGE,iBAAOyB,KAHT;AAIE,qBAAW,0BAAWI,iBAAOC,IAAlB,EAAwBP,SAAxB,CAJb;AAKE,mBAAS,KAAKF;AALhB;AAOGG;AAPH,OADF;AAWD;;;EA7HqBO,gB;;AAgIxBxD,UAAUyD,SAAV,GAAsB;AACpBT,aAAWU,oBAAUC,MADD;AAEpBV,YAAUS,oBAAUE,IAAV,CAAeC,UAFL;AAGpBd,WAASW,oBAAUI,IAHC;AAIpBvD,mBAAiBmD,oBAAUK,MAJP;AAKpBtD,mBAAiBiD,oBAAUK,MALP;AAMpBnB,wBAAsBc,oBAAUI,IANZ;AAOpBrB,kBAAgBiB,oBAAUK;AAPN,CAAtB;;AAUA/D,UAAUgE,YAAV,GAAyB;AACvBhB,aAAW,IADY;AAEvBD,WAAS;AAAA,WAAM,IAAN;AAAA,GAFc;AAGvBxC,mBAAiB,CAHM;AAIvBE,mBAAiB,CAJM;AAKvBmC,wBAAsB;AAAA,WAAM,IAAN;AAAA,GALC;AAMvBH,kBAAgB;AANO,CAAzB;;kBASezC,S","file":"index.js","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport classnames from 'classnames';\n\nimport styles from './styles.scss';\n/* eslint { \"react/no-unused-state\": 0 } */\n\nclass Draggable extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      dragging: false,\n      positionX: 0,\n      positionY: 0,\n      translateX: props.positionOffsetX,\n      translateY: props.positionOffsetY,\n    };\n\n    this._isClick = true;\n    this._onMouseDown = (e) => {\n      if (e.button !== 0) return;\n      if (this.state.dragging) {\n        return;\n      }\n      this.setState({\n        positionX: e.clientX,\n        positionY: e.clientY,\n        dragging: true,\n      });\n      this._positionXOnMouseDown = e.clientX;\n      this._positionYOnMouseDown = e.clientY;\n      this._isClick = true;\n      window.addEventListener('mousemove', this._onMouseMove, false);\n      window.addEventListener('mouseup', this._onMouseUp, false);\n      e.stopPropagation();\n      e.preventDefault();\n    };\n\n    this._onMouseMove = (e) => {\n      if (!this.state.dragging) {\n        return;\n      }\n      if (!this.draggableDom) {\n        return;\n      }\n      const {\n        offsetParent,\n        offsetLeft: originalPositionX,\n        offsetTop: originalPositionY,\n      } = this.draggableDom;\n      const newPositionX = e.clientX;\n      const newPositionY = e.clientY;\n      const child = this.draggableDom.firstChild;\n      const height = (child && child.clientHeight) || 0;\n      const width = (child && child.clientWidth) || 0;\n      if (\n        Math.abs(newPositionX - this._positionXOnMouseDown) > this.props.clickThreshold ||\n        Math.abs(newPositionY - this._positionYOnMouseDown) > this.props.clickThreshold\n      ) {\n        this._isClick = false;\n      }\n      this.setState((preState) => {\n        const newState = {\n          positionX: newPositionX,\n          positionY: newPositionY,\n          translateX: preState.translateX + (newPositionX - preState.positionX),\n          translateY: preState.translateY + (newPositionY - preState.positionY),\n        };\n        if (\n          (originalPositionX - 10) + newState.translateX > offsetParent.clientWidth ||\n          (originalPositionX - 10) + newState.translateX < width\n        ) {\n          delete newState.translateX;\n        }\n        if (\n          (originalPositionY + 10) + newState.translateY > offsetParent.clientHeight - height ||\n          (originalPositionY + 10) + newState.translateY < 0\n        ) {\n          delete newState.translateY;\n        }\n        return newState;\n      });\n      e.stopPropagation();\n      e.preventDefault();\n    };\n\n    this._onMouseUp = (e) => {\n      this.setState({\n        dragging: false,\n      });\n      this.props.updatePositionOffset(this.state.translateX, this.state.translateY);\n      window.removeEventListener('mousemove', this._onMouseMove);\n      window.removeEventListener('mouseup', this._onMouseUp);\n      e.stopPropagation();\n      e.preventDefault();\n    };\n\n    this._onClick = (e) => {\n      if (!this._isClick) {\n        return;\n      }\n      this.props.onClick(e);\n    };\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('mousemove', this._onMouseMove);\n    window.removeEventListener('mouseup', this._onMouseUp);\n  }\n\n  render() {\n    const {\n      className,\n      children,\n    } = this.props;\n    const style = {\n      msTransition: `translate(${this.state.translateX}px, ${this.state.translateY}px)`,\n      WebkitTransition: `translate(${this.state.translateX}px, ${this.state.translateY}px)`,\n      transform: `translate(${this.state.translateX}px, ${this.state.translateY}px)`,\n    };\n    return (\n      <div\n        onMouseDown={this._onMouseDown}\n        ref={(draggableDom) => { this.draggableDom = draggableDom; }}\n        style={style}\n        className={classnames(styles.root, className)}\n        onClick={this._onClick}\n        >\n        {children}\n      </div>\n    );\n  }\n}\n\nDraggable.propTypes = {\n  className: PropTypes.string,\n  children: PropTypes.node.isRequired,\n  onClick: PropTypes.func,\n  positionOffsetX: PropTypes.number,\n  positionOffsetY: PropTypes.number,\n  updatePositionOffset: PropTypes.func,\n  clickThreshold: PropTypes.number,\n};\n\nDraggable.defaultProps = {\n  className: null,\n  onClick: () => null,\n  positionOffsetX: 0,\n  positionOffsetY: 0,\n  updatePositionOffset: () => null,\n  clickThreshold: 5,\n};\n\nexport default Draggable;\n"]}