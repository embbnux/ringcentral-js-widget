{"version":3,"sources":["components/ComposeTextPanel/index.js"],"names":["SenderField","props","getString","currentLocale","senderInput","senderSelect","value","onChange","options","option","formatPhone","propTypes","string","isRequired","func","arrayOf","ComposeTextPanel","state","showAlert","hasSenderNumbers","outboundSMS","onSenderChange","e","currentTarget","updateSenderNumber","onReceiverChange","updateTypingToNumber","cleanReceiverValue","cleanTypingToNumber","onReceiverInputKeyDown","key","preventDefault","typingToNumber","length","addToNumber","name","phoneNumber","onReceiverInputKeyUp","searchContact","addToRecipients","receiver","removeFromRecipients","removeToNumber","onTextChange","updateMessageText","onTextAreaKeyDown","send","handleSubmit","console","debug","onDismissAlert","setState","getRenderer","messages","id","level","message","senderNumberInvalids","senderNumbers","noSenderAlert","senderField","senderNumber","root","receiverField","toNumbers","searchContactList","formatContactPhone","buttomField","textField","messageText","submitField","submitButton","sendButtonDisabled","bool","shape","entityType","phoneType","PropTypes","defaultProps"],"mappings":"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","file":"index.js","sourcesContent":["import React, { PropTypes, Component } from 'react';\nimport messageSenderMessages from\n'ringcentral-integration/modules/MessageSender/messageSenderMessages';\nimport i18n from './i18n';\nimport styles from './styles.scss';\nimport RecipientsInput from '../RecipientsInput';\nimport AlertDisplay from '../AlertDisplay';\nimport MessageSenderAlert from '../MessageSenderAlert';\nimport Select from '../Select';\n\nfunction SenderField(props) {\n  return (\n    <div>\n      <label>{i18n.getString('from', props.currentLocale)}:</label>\n      <div className={styles.senderInput}>\n        <Select\n          className={styles.senderSelect}\n          value={props.value}\n          onChange={props.onChange}\n          options={props.options}\n          paddingLeft={0}\n          valueFunction={option => option}\n          renderFunction={props.formatPhone}\n        />\n      </div>\n    </div>\n  );\n}\n\nSenderField.propTypes = {\n  currentLocale: PropTypes.string.isRequired,\n  value: PropTypes.string.isRequired,\n  onChange: PropTypes.func.isRequired,\n  formatPhone: PropTypes.func.isRequired,\n  options: PropTypes.arrayOf(PropTypes.string.isRequired).isRequired,\n};\n\nclass ComposeTextPanel extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      showAlert: !this.hasSenderNumbers() && this.props.outboundSMS,\n    };\n\n    this.onSenderChange = (e) => {\n      const value = e.currentTarget.value;\n      this.props.updateSenderNumber(value);\n    };\n\n    this.onReceiverChange = (e) => {\n      const value = e.currentTarget.value;\n      this.props.updateTypingToNumber(value);\n    };\n\n    this.cleanReceiverValue = () => {\n      this.props.cleanTypingToNumber();\n    };\n\n    this.onReceiverInputKeyDown = (e) => {\n      if (e.key === ',' || e.key === ';' || e.key === 'Enter') {\n        e.preventDefault();\n        if (this.props.typingToNumber.length === 0) {\n          return;\n        }\n        this.props.addToNumber({\n          name: this.props.typingToNumber,\n          phoneNumber: this.props.typingToNumber,\n        });\n        this.props.cleanTypingToNumber();\n      }\n    };\n\n    this.onReceiverInputKeyUp = (e) => {\n      this.props.searchContact(e.currentTarget.value);\n    };\n\n    this.addToRecipients = (receiver) => {\n      this.props.addToNumber(receiver);\n      this.props.cleanTypingToNumber();\n    };\n\n    this.removeFromRecipients = (phoneNumber) => {\n      this.props.removeToNumber({ phoneNumber });\n    };\n\n    this.onTextChange = (e) => {\n      const value = e.currentTarget.value;\n      this.props.updateMessageText(value);\n    };\n\n    this.onTextAreaKeyDown = (e) => {\n      if (e.key === 'Enter') {\n        e.preventDefault();\n        this.props.send();\n      }\n    };\n\n    this.handleSubmit = (e) => {\n      e.preventDefault();\n      this.props.send();\n      console.debug('send message ...');\n    };\n    this.onDismissAlert = () => {\n      this.setState({\n        showAlert: false\n      });\n    };\n    this.getRenderer = () => MessageSenderAlert;\n    this.messages = [\n      {\n        id: '1',\n        level: 'warning',\n        message: messageSenderMessages.senderNumberInvalids,\n      }\n    ];\n  }\n\n  hasSenderNumbers() {\n    return this.props.senderNumbers.length > 0;\n  }\n\n  render() {\n    const noSenderAlert = this.state.showAlert ? (\n      <AlertDisplay\n        currentLocale={this.props.currentLocale}\n        messages={this.messages}\n        dismiss={this.onDismissAlert}\n        getRenderer={this.getRenderer}\n      />\n    ) : null;\n    const senderField = this.hasSenderNumbers() ?\n      (\n        <SenderField\n          currentLocale={this.props.currentLocale}\n          value={this.props.senderNumber}\n          options={this.props.senderNumbers}\n          formatPhone={this.props.formatPhone}\n          onChange={this.onSenderChange}\n        />\n      ) : null;\n\n    return (\n      <div className={styles.root}>\n        {noSenderAlert}\n        <form onSubmit={this.handleSubmit}>\n          <div className={styles.receiverField}>\n            <RecipientsInput\n              value={this.props.typingToNumber}\n              label={`${i18n.getString('to', this.props.currentLocale)}:`}\n              onChange={this.onReceiverChange}\n              onClean={this.cleanReceiverValue}\n              placeholder={i18n.getString('enterNameOrNumber', this.props.currentLocale)}\n              recipients={this.props.toNumbers}\n              addToRecipients={this.addToRecipients}\n              removeFromRecipients={this.removeFromRecipients}\n              searchContactList={this.props.searchContactList}\n              onKeyUp={this.onReceiverInputKeyUp}\n              onKeyDown={this.onReceiverInputKeyDown}\n              formatContactPhone={this.props.formatContactPhone}\n            />\n          </div>\n          <div className={styles.senderField}>\n            {senderField}\n          </div>\n          <div className={styles.buttomField}>\n            <div className={styles.textField}>\n              <textarea\n                placeholder={i18n.getString('typeMessage', this.props.currentLocale)}\n                value={this.props.messageText}\n                maxLength=\"1000\"\n                onChange={this.onTextChange}\n                onKeyDown={this.onTextAreaKeyDown}\n              />\n            </div>\n            <div className={styles.submitField}>\n              <input\n                type=\"submit\"\n                value={i18n.getString('send', this.props.currentLocale)}\n                className={styles.submitButton}\n                disabled={this.props.sendButtonDisabled}\n              />\n            </div>\n          </div>\n        </form>\n      </div>\n    );\n  }\n}\n\nComposeTextPanel.propTypes = {\n  send: PropTypes.func.isRequired,\n  senderNumbers: PropTypes.arrayOf(PropTypes.string.isRequired).isRequired,\n  sendButtonDisabled: PropTypes.bool.isRequired,\n  formatPhone: PropTypes.func.isRequired,\n  formatContactPhone: PropTypes.func.isRequired,\n  searchContact: PropTypes.func.isRequired,\n  searchContactList: PropTypes.arrayOf(PropTypes.shape({\n    name: PropTypes.string.isRequired,\n    entityType: PropTypes.string.isRequired,\n    phoneType: PropTypes.string.isRequired,\n    phoneNumber: PropTypes.string.isRequired,\n  })).isRequired,\n  currentLocale: PropTypes.string.isRequired,\n  updateSenderNumber: PropTypes.func.isRequired,\n  updateTypingToNumber: PropTypes.func.isRequired,\n  cleanTypingToNumber: PropTypes.func.isRequired,\n  addToNumber: PropTypes.func.isRequired,\n  removeToNumber: PropTypes.func.isRequired,\n  updateMessageText: PropTypes.func.isRequired,\n  messageText: PropTypes.string,\n  typingToNumber: PropTypes.string,\n  senderNumber: PropTypes.string,\n  toNumbers: React.PropTypes.arrayOf(PropTypes.shape({\n    phoneNumber: PropTypes.string.isRequired,\n    name: PropTypes.string.isRequired,\n  })).isRequired,\n  outboundSMS: PropTypes.bool,\n};\n\nComposeTextPanel.defaultProps = {\n  messageText: '',\n  typingToNumber: '',\n  senderNumber: '',\n  outboundSMS: false,\n};\n\nexport default ComposeTextPanel;\n"]}