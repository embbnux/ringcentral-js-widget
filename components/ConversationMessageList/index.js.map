{"version":3,"sources":["components/ConversationMessageList/index.js"],"names":["MessageItem","props","messageClassName","messageBody","direction","outbound","inbound","fromName","senderName","messageFrom","messageCreationTime","showDate","messsageTime","creationTime","messageItem","subject","clear","propTypes","string","isRequired","bool","defaultProps","ConversationMessageList","lastMessagesLength","scrollToLastMessage","conversationBody","messages","length","scrollTop","scrollHeight","lastFormatedTime","messageList","map","message","formatedTime","context","formatDateTime","showSender","from","name","phoneNumber","extensionNumber","formatPhone","id","root","className","body","PropTypes","arrayOf","shape","number","contextTypes","func"],"mappings":"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","file":"index.js","sourcesContent":["import React, { PropTypes, Component } from 'react';\nimport classnames from 'classnames';\n\nimport styles from './styles.scss';\n\nfunction MessageItem(props) {\n  const messageClassName = classnames(\n    styles.messageBody,\n    props.direction === 'Outbound' ? styles.outbound : styles.inbound,\n  );\n  const fromName = props.senderName && props.direction === 'Inbound' ?\n    (\n      <div className={styles.messageFrom}>\n        {props.senderName}\n      </div>\n    ) :\n    null;\n  const messageCreationTime = props.showDate ?\n    (\n      <div className={styles.messsageTime}>\n        {props.creationTime}\n      </div>\n    ) :\n    null;\n  return (\n    <div className={styles.messageItem}>\n      {messageCreationTime}\n      {fromName}\n      <div className={messageClassName}>\n        {props.subject}\n      </div>\n      <div className={styles.clear} />\n    </div>\n  );\n}\n\nMessageItem.propTypes = {\n  direction: PropTypes.string.isRequired,\n  subject: PropTypes.string,\n  creationTime: PropTypes.string.isRequired,\n  showDate: PropTypes.bool.isRequired,\n  senderName: PropTypes.string,\n};\n\nMessageItem.defaultProps = {\n  subject: '',\n  senderName: null,\n};\n\nclass ConversationMessageList extends Component {\n  constructor(props) {\n    super(props);\n    let lastMessagesLength = 0;\n    this.scrollToLastMessage = () => {\n      const conversationBody = this.conversationBody;\n      if (!conversationBody) {\n        return;\n      }\n      if (this.props.messages.length === lastMessagesLength) {\n        return;\n      }\n      lastMessagesLength = props.messages.length;\n      conversationBody.scrollTop = conversationBody.scrollHeight;\n    };\n  }\n\n  componentDidMount() {\n    this.scrollToLastMessage();\n  }\n\n  componentDidUpdate() {\n    this.scrollToLastMessage();\n  }\n\n  render() {\n    const messages = this.props.messages;\n    let lastFormatedTime = null;\n    const messageList = messages.map((message) => {\n      const formatedTime = this.context.formatDateTime(message.creationTime);\n      let showDate = true;\n      if (lastFormatedTime === formatedTime) {\n        showDate = false;\n      }\n      lastFormatedTime = formatedTime;\n      let senderName = null;\n      if (this.props.showSender && message.from) {\n        if (message.from.name) {\n          senderName = message.from.name;\n        } else {\n          const phoneNumber = message.from.extensionNumber || message.from.phoneNumber;\n          senderName = this.context.formatPhone(phoneNumber);\n        }\n      }\n      return (\n        <MessageItem\n          key={message.id}\n          direction={message.direction}\n          subject={message.subject}\n          creationTime={formatedTime}\n          showDate={showDate}\n          senderName={senderName}\n        />\n      );\n    });\n    return (\n      <div\n        className={classnames(styles.root, this.props.className)}\n        ref={(body) => { this.conversationBody = body; }}\n      >\n        {messageList}\n      </div>\n    );\n  }\n}\n\nConversationMessageList.propTypes = {\n  messages: React.PropTypes.arrayOf(PropTypes.shape({\n    creationTime: PropTypes.string,\n    id: PropTypes.number,\n    direction: PropTypes.string,\n    subject: PropTypes.string,\n  })).isRequired,\n  className: PropTypes.string,\n  showSender: PropTypes.bool,\n};\n\nConversationMessageList.defaultProps = {\n  className: null,\n  showSender: false,\n};\n\nConversationMessageList.contextTypes = {\n  formatDateTime: PropTypes.func.isRequired,\n  formatPhone: PropTypes.func.isRequired,\n};\n\nexport default ConversationMessageList;\n"]}