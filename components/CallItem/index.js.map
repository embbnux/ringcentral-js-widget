{"version":3,"sources":["components/CallItem/index.js"],"names":["callIconMap","inbound","outbound","missed","CallIcon","direction","active","ringing","callIcon","activeCall","propTypes","string","isRequired","bool","defaultProps","Contact","contactMatches","selected","onSelectContact","disabled","isLogging","fallBackName","areaCode","countryCode","phoneNumber","currentLocale","contentEl","length","getString","name","options","select","_","idx","entity","entityType","value","parseInt","contact","arrayOf","any","number","func","undefined","CallItem","props","setState","userSelection","call","activityMatches","logCall","redirect","getSelectedContact","state","getContactMatches","onLogCall","_mounted","viewSelectedContact","onViewContact","getPhoneNumber","clickToSms","onClickToSms","getFallbackContactName","clickToDial","onClickToDial","getInitialContactIndex","nextProps","activity","index","findIndex","isLoggedContact","from","extensionNumber","to","fromMatches","toMatches","telephonyStatus","result","startTime","duration","disableLinks","disableClickToDial","outboundSmsPermission","internalSmsPermission","dateTimeFormatter","fallbackContactName","parsedInfo","isExtension","hasPlus","showClickToSms","durationEl","dateEl","statusEl","callItem","details","shape","array"],"mappings":"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","file":"index.js","sourcesContent":["import React, { PropTypes, Component } from 'react';\nimport classnames from 'classnames';\nimport 'core-js/fn/array/find';\nimport callDirections from 'ringcentral-integration/enums/callDirections';\nimport {\n  isInbound,\n  isRinging,\n} from 'ringcentral-integration/lib/callLogHelpers';\nimport parseNumber from 'ringcentral-integration/lib/parseNumber';\nimport formatNumber from 'ringcentral-integration/lib/formatNumber';\nimport callResults from 'ringcentral-integration/enums/callResults';\nimport dynamicsFont from '../../assets/DynamicsFont/DynamicsFont.scss';\nimport Select from '../DropdownSelect';\nimport DurationCounter from '../DurationCounter';\nimport formatDuration from '../../lib/formatDuration';\nimport ActionMenu from '../ActionMenu';\nimport styles from './styles.scss';\n\nimport i18n from './i18n';\n\nconst callIconMap = {\n  [callDirections.inbound]: dynamicsFont.inbound,\n  [callDirections.outbound]: dynamicsFont.outbound,\n  missed: dynamicsFont.missed,\n};\n\nfunction CallIcon({\n  direction,\n  missed,\n  active,\n  ringing,\n}) {\n  return (\n    <div className={styles.callIcon}>\n      <span\n        className={classnames(\n          missed ? callIconMap.missed : callIconMap[direction],\n          active && styles.activeCall,\n          ringing && styles.ringing,\n          missed && styles.missed,\n        )} />\n    </div>\n  );\n}\nCallIcon.propTypes = {\n  direction: PropTypes.string.isRequired,\n  missed: PropTypes.bool,\n  active: PropTypes.bool,\n  ringing: PropTypes.bool,\n};\nCallIcon.defaultProps = {\n  missed: false,\n  active: false,\n  ringing: false,\n};\n\n\nfunction Contact({\n  contactMatches,\n  selected,\n  onSelectContact,\n  disabled,\n  isLogging,\n  fallBackName,\n  areaCode,\n  countryCode,\n  phoneNumber,\n  currentLocale,\n  missed,\n}) {\n  let contentEl;\n\n  if (contactMatches.length === 0) {\n    contentEl = fallBackName ||\n      (phoneNumber && formatNumber({\n        phoneNumber,\n        countryCode,\n        areaCode,\n      })) ||\n      i18n.getString('unknownNumber', currentLocale);\n  } else if (contactMatches.length === 1) {\n    contentEl = contactMatches[0].name;\n  } else if (contactMatches.length > 1) {\n    const options = [\n      {\n\n      },\n      ...contactMatches,\n    ];\n\n    contentEl = (\n      <Select\n        className={styles.select}\n        value={`${selected}`}\n        onChange={onSelectContact}\n        disabled={disabled || isLogging}\n        options={options}\n        valueFunction={(_, idx) => `${idx - 1}`}\n        renderFunction={(entity, idx) => (\n          idx === 0 ?\n            i18n.getString('select', currentLocale) :\n            `${entity.name} ${i18n.getString(`phoneSource.${entity.entityType}`)}`\n        )}\n        renderValue={(value) => {\n          value = parseInt(value, 10) + 1;\n          return value === 0 ?\n            i18n.getString('select', currentLocale) :\n            `${options[value].name} ${i18n.getString(`phoneSource.${options[value].entityType}`)}`;\n        }}\n        dropdownAlign=\"left\"\n        titleEnabled\n      />\n    );\n  }\n  return (\n    <div\n      className={classnames(\n        styles.contact,\n        missed && styles.missed,\n      )} >\n      {contentEl}\n    </div>\n  );\n}\nContact.propTypes = {\n  contactMatches: PropTypes.arrayOf(PropTypes.any).isRequired,\n  selected: PropTypes.number.isRequired,\n  onSelectContact: PropTypes.func,\n  disabled: PropTypes.bool.isRequired,\n  isLogging: PropTypes.bool.isRequired,\n  fallBackName: PropTypes.string,\n  areaCode: PropTypes.string.isRequired,\n  countryCode: PropTypes.string.isRequired,\n  phoneNumber: PropTypes.string,\n  currentLocale: PropTypes.string.isRequired,\n  missed: PropTypes.bool.isRequired,\n};\nContact.defaultProps = {\n  onSelectContact: undefined,\n  fallBackName: '',\n  phoneNumber: undefined,\n};\n\n\nexport default class CallItem extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      selected: this.getInitialContactIndex(),\n      userSelection: false,\n      isLogging: false,\n    };\n  }\n  componentDidMount() {\n    this._mounted = true;\n  }\n  componentWillReceiveProps(nextProps) {\n    if (\n      !this.state.userSelection &&\n      nextProps.call.activityMatches !== this.props.call.activityMatches\n    ) {\n      this.setState({\n        selected: this.getInitialContactIndex(nextProps),\n      });\n    }\n  }\n  componentWillUnmount() {\n    this._mounted = false;\n  }\n  onSelectContact = (value, idx) => {\n    const selected = parseInt(idx, 10) - 1;\n    this.setState({\n      selected,\n      userSelection: true,\n    });\n    if (this.props.call.activityMatches.length > 0) {\n      this.logCall({ redirect: false, selected });\n    }\n  }\n  getInitialContactIndex(nextProps = this.props) {\n    const contactMatches = this.getContactMatches(nextProps);\n    const activityMatches = nextProps.call.activityMatches;\n    for (const activity of activityMatches) {\n      const index = contactMatches.findIndex(contact => (\n        // TODO find a better name or mechanism...\n        this.props.isLoggedContact(nextProps.call, activity, contact)\n      ));\n      if (index > -1) return index;\n    }\n    return -1;\n  }\n  getSelectedContact = (selected = this.state.selected) => {\n    const contactMatches = this.getContactMatches();\n    return (selected > -1 && contactMatches[selected]) ||\n      (contactMatches.length === 1 && contactMatches[0]) ||\n      null;\n  }\n  getPhoneNumber() {\n    return isInbound(this.props.call) ?\n      (this.props.call.from.phoneNumber || this.props.call.from.extensionNumber) :\n      (this.props.call.to.phoneNumber || this.props.call.to.extensionNumber);\n  }\n  getContactMatches(nextProps = this.props) {\n    return isInbound(nextProps.call) ?\n      nextProps.call.fromMatches :\n      nextProps.call.toMatches;\n  }\n  getFallbackContactName() {\n    return isInbound(this.props.call) ?\n      (this.props.call.from.name) :\n      (this.props.call.to.name);\n  }\n  logCall = async ({ redirect = true, selected }) => {\n    if (\n      typeof this.props.onLogCall === 'function' &&\n      this._mounted &&\n      !this.state.isLogging\n    ) {\n      this.setState({\n        isLogging: true,\n      });\n      await this.props.onLogCall({\n        contact: this.getSelectedContact(selected),\n        call: this.props.call,\n        redirect,\n      });\n      if (this._mounted) {\n        this.setState({\n          isLogging: false,\n        });\n      }\n    }\n  }\n  viewSelectedContact = () => {\n    if (typeof this.props.onViewContact === 'function') {\n      this.props.onViewContact({\n        phoneNumber: this.getPhoneNumber(),\n        contact: this.getSelectedContact(),\n      });\n    }\n  }\n  clickToSms = () => {\n    if (this.props.onClickToSms) {\n      const phoneNumber = this.getPhoneNumber();\n      const contact = this.getSelectedContact();\n      if (contact) {\n        this.props.onClickToSms({\n          ...contact,\n          phoneNumber,\n        });\n      } else {\n        this.props.onClickToSms({\n          name: this.getFallbackContactName(),\n          phoneNumber,\n        });\n      }\n    }\n  }\n  clickToDial = () => {\n    if (this.props.onClickToDial) {\n      this.props.onClickToDial(this.getPhoneNumber());\n    }\n  }\n  render() {\n    const {\n      call: {\n        direction,\n        telephonyStatus,\n        result,\n        startTime,\n        duration,\n        activityMatches,\n      },\n      currentLocale,\n      areaCode,\n      countryCode,\n      disableLinks,\n      disableClickToDial,\n      outboundSmsPermission,\n      internalSmsPermission,\n      active,\n      onViewContact,\n      onLogCall,\n      onClickToDial,\n      onClickToSms,\n      dateTimeFormatter,\n      isLogging,\n    } = this.props;\n    const phoneNumber = this.getPhoneNumber();\n    const contactMatches = this.getContactMatches();\n    const fallbackContactName = this.getFallbackContactName();\n    const ringing = isRinging(this.props.call);\n    const missed = result === callResults.missed;\n    const parsedInfo = parseNumber(phoneNumber);\n    const isExtension = !parsedInfo.hasPlus &&\n      parsedInfo.number.length <= 6;\n    const showClickToSms = !!(\n      onClickToSms &&\n      (\n        isExtension ?\n          internalSmsPermission :\n          outboundSmsPermission\n      )\n    );\n\n    let durationEl;\n    if (typeof duration === 'undefined') {\n      durationEl = disableLinks ?\n        i18n.getString('unavailable', currentLocale) :\n        <DurationCounter startTime={startTime} />;\n    } else {\n      durationEl = formatDuration(duration);\n    }\n    let dateEl;\n    if (!active) {\n      dateEl = dateTimeFormatter(startTime);\n    }\n    let statusEl;\n    if (active) {\n      statusEl = i18n.getString(result || telephonyStatus, currentLocale);\n    }\n    return (\n      <div className={styles.callItem}>\n        <CallIcon\n          direction={direction}\n          ringing={ringing}\n          active={active}\n          missed={missed}\n        />\n        <Contact\n          contactMatches={contactMatches}\n          selected={this.state.selected}\n          onSelectContact={this.onSelectContact}\n          disabled={disableLinks}\n          isLogging={isLogging || this.state.isLogging}\n          fallBackName={fallbackContactName}\n          areaCode={areaCode}\n          countryCode={countryCode}\n          phoneNumber={phoneNumber}\n          currentLocale={currentLocale}\n          missed={missed} />\n        <div className={styles.details} >\n          {durationEl} | {dateEl}{statusEl}\n        </div>\n        <ActionMenu\n          currentLocale={currentLocale}\n          onLogCall={onLogCall && this.logCall}\n          onViewEntity={onViewContact && this.viewSelectedContact}\n          hasEntity={!!contactMatches.length}\n          onClickToDial={onClickToDial && this.clickToDial}\n          onClickToSms={showClickToSms && this.clickToSms}\n          phoneNumber={phoneNumber}\n          disableLinks={disableLinks}\n          disableClickToDial={disableClickToDial}\n          isLogging={isLogging || this.state.isLogging}\n          isLogged={activityMatches.length > 0}\n        />\n      </div>\n    );\n  }\n}\n\nCallItem.propTypes = {\n  call: PropTypes.shape({\n    direction: PropTypes.string.isRequired,\n    telephonyStatus: PropTypes.string,\n    startTime: PropTypes.number.isRequired,\n    activityMatches: PropTypes.array.isRequired,\n    fromMatches: PropTypes.array.isRequired,\n    toMatches: PropTypes.array.isRequired,\n    from: PropTypes.shape({\n      phoneNumber: PropTypes.string,\n      extensionNumber: PropTypes.string,\n      name: PropTypes.string,\n    }).isRequired,\n    to: PropTypes.shape({\n      phoneNumber: PropTypes.string,\n      extensionNumber: PropTypes.string,\n      name: PropTypes.string,\n    }),\n  }).isRequired,\n  areaCode: PropTypes.string.isRequired,\n  countryCode: PropTypes.string.isRequired,\n  currentLocale: PropTypes.string.isRequired,\n  onLogCall: PropTypes.func,\n  onViewContact: PropTypes.func,\n  onClickToDial: PropTypes.func,\n  onClickToSms: PropTypes.func,\n  isLoggedContact: PropTypes.func,\n  disableLinks: PropTypes.bool,\n  disableClickToDial: PropTypes.bool,\n  outboundSmsPermission: PropTypes.bool,\n  internalSmsPermission: PropTypes.bool,\n  active: PropTypes.bool.isRequired,\n  dateTimeFormatter: PropTypes.func.isRequired,\n  isLogging: PropTypes.bool,\n};\n\nCallItem.defaultProps = {\n  onLogCall: undefined,\n  onClickToDial: undefined,\n  onClickToSms: undefined,\n  onViewContact: undefined,\n  isLoggedContact: () => false,\n  isLogging: false,\n  disableClickToDial: false,\n  outboundSmsPermission: false,\n  internalSmsPermission: false,\n  disableLinks: false,\n};\n"]}