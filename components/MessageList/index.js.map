{"version":3,"sources":["components/MessageList/index.js"],"names":["NoMessages","props","noMessages","placeholder","propTypes","string","isRequired","MessageList","onScroll","totalScrollHeight","messagesListBody","scrollHeight","clientHeight","currentScrollTop","scrollTop","_scrollTop","setState","page","state","className","currentLocale","conversations","searchInput","onSearchInputChange","perPage","disableLinks","childProps","search","getString","length","lastIndex","content","slice","map","item","id","root","contentWithSearch","list","arrayOf","shape","number","conversationId","subject","bool","func","showConversationDetail","dateTimeFormatter","defaultProps","undefined"],"mappings":"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","file":"index.js","sourcesContent":["import React, { Component, PropTypes } from 'react';\nimport classnames from 'classnames';\nimport SearchInput from '../SearchInput';\nimport Panel from '../Panel';\nimport MessageItem from '../MessageItem';\nimport styles from './styles.scss';\nimport i18n from './i18n';\n\nfunction NoMessages(props) {\n  return (\n    <p className={styles.noMessages}>{props.placeholder}</p>\n  );\n}\n\nNoMessages.propTypes = {\n  placeholder: PropTypes.string.isRequired,\n};\n\nexport default class MessageList extends Component {\n  constructor(props) {\n    super(props);\n    this._scrollTop = 0;\n    this.state = {\n      page: 0,\n    };\n  }\n  onScroll = () => {\n    const totalScrollHeight = this.messagesListBody.scrollHeight;\n    const clientHeight = this.messagesListBody.clientHeight;\n    const currentScrollTop = this.messagesListBody.scrollTop;\n    // load next page if scroll near buttom\n    if (\n      (totalScrollHeight - this._scrollTop) > (clientHeight + 10) &&\n      (totalScrollHeight - currentScrollTop) <= (clientHeight + 10)\n    ) {\n      this.setState({\n        page: this.state.page + 1,\n      });\n    }\n    this._scrollTop = currentScrollTop;\n  }\n\n  render() {\n    const {\n      className,\n      currentLocale,\n      conversations,\n      searchInput,\n      onSearchInputChange,\n      perPage,\n      disableLinks,\n      ...childProps,\n    } = this.props;\n\n    const search = onSearchInputChange ?\n      (\n        <SearchInput\n          value={searchInput}\n          onChange={onSearchInputChange}\n          placeholder={i18n.getString('search', currentLocale)}\n          disabled={disableLinks}\n        />\n      ) :\n      null;\n    const placeholder = onSearchInputChange && searchInput.length > 0 ?\n      i18n.getString('noSearchResults', currentLocale) :\n      i18n.getString('noMessages', currentLocale);\n\n    const lastIndex = ((this.state.page + 1) * perPage) - 1;\n\n    const content = (conversations && conversations.length) ?\n      conversations.slice(0, lastIndex).map(item => (\n        <MessageItem\n          {...childProps}\n          conversation={item}\n          currentLocale={currentLocale}\n          key={item.id}\n          disableLinks={disableLinks}\n        />\n      ))\n      : <NoMessages placeholder={placeholder} />;\n    return (\n      <div className={classnames(styles.root, className)}>\n        {search}\n        <div\n          className={classnames(styles.content, styles.contentWithSearch)}\n          onScroll={this.onScroll}\n          ref={(list) => { this.messagesListBody = list; }}\n          >\n          {content}\n        </div>\n      </div>\n    );\n  }\n}\n\nMessageList.propTypes = {\n  currentLocale: PropTypes.string.isRequired,\n  conversations: PropTypes.arrayOf(PropTypes.shape({\n    id: PropTypes.number,\n    conversationId: PropTypes.string.isRequired,\n    subject: PropTypes.string,\n  })).isRequired,\n  disableLinks: PropTypes.bool,\n  onSearchInputChange: PropTypes.func,\n  searchInput: PropTypes.string,\n  perPage: PropTypes.number,\n  className: PropTypes.string,\n  showConversationDetail: PropTypes.func.isRequired,\n  dateTimeFormatter: PropTypes.func,\n};\nMessageList.defaultProps = {\n  onSearchInputChange: undefined,\n  searchInput: '',\n  perPage: 20,\n  className: undefined,\n  disableLinks: false,\n  dateTimeFormatter: undefined,\n};\n"]}