{"version":3,"sources":["components/UserGuide/index.js"],"names":["controlStyles","entered","transform","UserGuide","props","slideTo","idx","guides","length","exit","setState","curIdx","updateCarousel","state","playing","quickAccessEnter","firstLogin","onExited","nextProps","styles","intro","introBg","backgroundImage","buttonGroup","primaryButton","i18n","getString","currentLocale","secondaryButton","slice","imageView","map","guide","i","view","indicatorView","_","highlight","dot","onLastPage","skipButton","nextButton","controlView","control","indicator","carousel","carouselBox","getIntroView","showSpinner","getCarouselView","appear","enter","appearActive","enterActive","exitActive","root","React","Component","propTypes","PropTypes","number","bool","func","array","isRequired","string","defaultProps","undefined"],"mappings":"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","file":"index.js","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport classnames from 'classnames';\nimport { Transition, CSSTransition } from 'react-transition-group';\nimport SpinnerOverlay from '../SpinnerOverlay';\nimport Button from '../Button';\nimport styles from './styles.scss';\nimport i18n from './i18n';\n\nconst controlStyles = {\n  entered: { transform: 'translateY(0)' }\n};\n\nexport default class UserGuide extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      curIdx: props.curIdx || 0,\n      entered: props.entered || false,\n      playing: props.playing || false\n    };\n  }\n\n  componentWillReceiveProps(nextProps) {\n    const { curIdx, entered, playing } = nextProps;\n    if (this.state.curIdx !== curIdx) {\n      this.setState({ curIdx });\n    }\n    if (this.state.entered !== entered) {\n      this.setState({ entered });\n    }\n    if (this.state.playing !== playing) {\n      this.setState({ playing });\n    }\n  }\n\n  slideTo = (idx) => {\n    if (idx > this.props.guides.length - 1) {\n      this.exit();\n      return;\n    }\n    this.setState({\n      curIdx: idx\n    });\n    this.props.updateCarousel({\n      curIdx: idx,\n      entered: this.state.entered,\n      playing: this.state.playing\n    });\n  }\n\n  exit = () => {\n    if (this.props.quickAccessEnter && this.props.firstLogin) {\n      this.setState({\n        playing: false,\n      });\n      this.props.updateCarousel({\n        curIdx: this.state.curIdx,\n        entered: this.state.entered,\n        playing: false\n      });\n      this.props.quickAccessEnter();\n    } else {\n      this.setState({\n        playing: false,\n      });\n      this.onExited();\n    }\n  }\n\n  onExited = () => {\n    this.setState({\n      entered: false\n    });\n    this.props.updateCarousel({\n      curIdx: 0,\n      entered: false,\n      playing: false,\n      firstLogin: false\n    });\n  }\n\n  getIntroView() {\n    return (\n      <div className={styles.intro}>\n        <div\n          className={styles.introBg}\n          style={{ backgroundImage: `url(${this.props.guides[0]})` }}\n        />\n        <div className={styles.buttonGroup}>\n          <Button\n            className={styles.primaryButton}\n            onClick={() => { this.slideTo(1); }}\n          >\n            {i18n.getString('start', this.props.currentLocale)}\n          </Button>\n          <Button\n            onClick={() => { this.exit(); }}\n            className={styles.secondaryButton}\n          >\n            {i18n.getString('skip', this.props.currentLocale)}\n          </Button>\n        </div>\n      </div>\n    );\n  }\n\n  getCarouselView() {\n    const guides = this.props.guides.slice(1, this.props.guides.length);\n    const imageView = guides.map((guide, i) => (\n      <div\n        key={i}\n        className={styles.view}\n        style={{\n          backgroundImage: `url(${guide})`,\n          transform: `translateX(${(i + 1) * 100}vw)`\n        }}\n      />\n    ));\n    const indicatorView = guides.map((_, i) => {\n      const highlight = i + 1 === this.state.curIdx ? styles.highlight : null;\n      return (\n        <li\n          key={i}\n          className={classnames(styles.dot, highlight)}\n          onClick={() => { this.slideTo(i + 1); }}\n        />\n      );\n    });\n    const onLastPage = this.state.curIdx === this.props.guides.length - 1;\n    const skipButton = onLastPage\n      ? (<div className={styles.secondaryButton} />)\n      : (\n        <Button\n          onClick={() => { this.exit(); }}\n          className={classnames(styles.secondaryButton)}\n        >\n          {i18n.getString('skip', this.props.currentLocale)}\n        </Button>\n      );\n    const nextButton = (\n      <Button\n        onClick={() => { this.slideTo(this.state.curIdx + 1); }}\n        className={classnames(styles.primaryButton)}\n      >\n        {onLastPage\n          ? i18n.getString('finish', this.props.currentLocale)\n          : i18n.getString('next', this.props.currentLocale)}\n      </Button>\n    );\n    const controlView = (\n      <Transition\n        in={this.state.curIdx > 0}\n        timeout={300}\n      >\n        {state => (\n          <div className={styles.control} style={{ ...controlStyles[state] }}>\n            {skipButton}\n            <ul className={styles.indicator}>\n              {indicatorView}\n            </ul>\n            {nextButton}\n          </div>\n        )}\n      </Transition>\n    );\n    return (\n      <div className={styles.carousel}>\n        <div\n          className={styles.carouselBox}\n          style={{ transform: `translateX(-${this.state.curIdx * 100}vw)` }}\n        >\n          {this.getIntroView()}\n          {imageView}\n        </div>\n        {controlView}\n      </div>\n    );\n  }\n\n  render() {\n    if (!this.state.entered) return null;\n    if (this.props.showSpinner) {\n      return <SpinnerOverlay />;\n    }\n    const view = this.getCarouselView();\n    return (\n      <CSSTransition\n        in={this.state.playing}\n        timeout={400}\n        classNames={{\n          appear: styles.enter,\n          appearActive: styles.enterActive,\n          exit: styles.exit,\n          exitActive: styles.exitActive\n        }}\n        onExited={this.onExited}\n        appear\n      >\n        <div className={styles.root}>\n          {view}\n        </div>\n      </CSSTransition>\n    );\n  }\n}\n\nUserGuide.propTypes = {\n  curIdx: PropTypes.number,\n  entered: PropTypes.bool,\n  playing: PropTypes.bool,\n  firstLogin: PropTypes.bool,\n  updateCarousel: PropTypes.func,\n  quickAccessEnter: PropTypes.func,\n  guides: PropTypes.array.isRequired,\n  showSpinner: PropTypes.bool.isRequired,\n  currentLocale: PropTypes.string.isRequired,\n};\n\nUserGuide.defaultProps = {\n  curIdx: 0,\n  entered: false,\n  playing: false,\n  firstLogin: false,\n  updateCarousel: () => null,\n  quickAccessEnter: undefined\n};\n"]}