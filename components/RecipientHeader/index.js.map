{"version":3,"sources":["components/RecipientHeader/index.js"],"names":["RecipientName","props","className","recipient","onClick","title","name","propTypes","string","isRequired","func","defaultProps","MatchedNameList","matchedNames","getString","currentLocale","noClick","map","matchedName","setDefaultMatchedName","isSelected","bool","arrayOf","RecipientHeader","state","showDropdownList","toggleDropdown","setState","preState","phoneNumber","extensionNumber","context","getMatcherContactList","newMatchedNames","filter","concat","changeMatchedNames","length","hasDropdown","recipientName","getRecipientName","dropdownClass","dropdownClassName","dropdownArrowClass","arrow","dropdownIcon","active","dropdownActiveIcon","matchedNamesOnly","getMatcherContactNameList","defaultRecipient","join","firstMatchedName","isFind","find","slice","indexOf","oldMatchedNames","sort","dropdownButton","shape","array","contextTypes"],"mappings":"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","file":"index.js","sourcesContent":["import React, { PropTypes, Component } from 'react';\nimport classnames from 'classnames';\n\nimport dynamicsFont from '../../assets/DynamicsFont/DynamicsFont.scss';\n\nimport styles from './styles.scss';\nimport i18n from './i18n';\n\nfunction RecipientName(props) {\n  const className = classnames(styles.recipient, props.className);\n  return (\n    <a href=\"#recipient\" className={className} onClick={props.onClick} title={props.title}>\n      {props.name}\n    </a>\n  );\n}\n\nRecipientName.propTypes = {\n  name: PropTypes.string.isRequired,\n  onClick: PropTypes.func.isRequired,\n  className: PropTypes.string,\n  title: PropTypes.string,\n};\n\nRecipientName.defaultProps = {\n  className: null,\n  title: null,\n};\n\nfunction MatchedNameList(props) {\n  const matchedNames = props.matchedNames;\n  return (\n    <div className={props.className}>\n      <RecipientName\n        name={i18n.getString('selectMatchedName', props.currentLocale)}\n        className={styles.noClick}\n        onClick={\n          () => null\n        }\n      />\n      {\n        matchedNames.map(matchedName => (\n          <RecipientName\n            key={matchedName}\n            name={matchedName}\n            title={matchedName}\n            onClick={\n              () => props.setDefaultMatchedName(matchedName)\n            }\n          />\n        ))\n      }\n    </div>\n  );\n}\n\nMatchedNameList.propTypes = {\n  currentLocale: PropTypes.string.isRequired,\n  isSelected: PropTypes.bool.isRequired,\n  className: PropTypes.string.isRequired,\n  matchedNames: PropTypes.arrayOf(PropTypes.string).isRequired,\n};\n\nclass RecipientHeader extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      showDropdownList: false,\n    };\n    this.toggleDropdown = () => {\n      this.setState(preState => ({\n        showDropdownList: !preState.showDropdownList,\n      }));\n    };\n    this.setDefaultMatchedName = (matchedName) => {\n      const recipient = this.props.recipient;\n      const phoneNumber = recipient.phoneNumber || recipient.extensionNumber;\n      const matchedNames = this.context.getMatcherContactList(phoneNumber);\n      if (!matchedNames) {\n        return;\n      }\n      let newMatchedNames = matchedNames.filter(name => name !== matchedName);\n      newMatchedNames = [matchedName].concat(newMatchedNames);\n      this.context.changeMatchedNames(newMatchedNames);\n      this.toggleDropdown();\n    };\n  }\n\n  hasDropdown() {\n    const recipient = this.props.recipient;\n    const phoneNumber = recipient.phoneNumber || recipient.extensionNumber;\n    const matchedNames = this.context.getMatcherContactList(phoneNumber);\n    return matchedNames.length > 1;\n  }\n\n  render() {\n    const recipient = this.props.recipient;\n    const hasDropdown = this.hasDropdown();\n    if (!hasDropdown) {\n      const recipientName = this.context.getRecipientName(recipient);\n      return (\n        <span className={styles.title} title={recipientName}>\n          {recipientName}\n        </span>\n      );\n    }\n    let dropdownClass = this.props.dropdownClassName;\n    let dropdownArrowClass = classnames(dynamicsFont.arrow, styles.dropdownIcon);\n    if (this.state.showDropdownList) {\n      dropdownClass = classnames(dropdownClass, styles.active);\n      dropdownArrowClass = classnames(dynamicsFont.arrow, styles.dropdownActiveIcon);\n    }\n    const phoneNumber = recipient.phoneNumber || recipient.extensionNumber;\n    let matchedNames = this.context.getMatcherContactList(phoneNumber);\n    const matchedNamesOnly = this.context.getMatcherContactNameList(phoneNumber);\n    let defaultRecipient = matchedNamesOnly.join('&');\n    // if it has old data\n    let isSelected = false;\n    if (recipient.matchedNames && recipient.matchedNames[0]) {\n      const firstMatchedName = recipient.matchedNames[0];\n      const isFind = matchedNames.find(name => name === firstMatchedName);\n      if (isFind) {\n        isSelected = true;\n        defaultRecipient = firstMatchedName.slice(0, firstMatchedName.indexOf('|'));\n      }\n      const oldMatchedNames = recipient.matchedNames.slice().sort();\n      if (matchedNames.sort().join('') === oldMatchedNames.join('')) {\n        matchedNames = oldMatchedNames;\n      }\n    }\n    return (\n      <div>\n        <RecipientName\n          name={defaultRecipient}\n          title={defaultRecipient}\n          onClick={this.toggleDropdown}\n          className={styles.dropdownButton}\n        />\n        <i\n          className={dropdownArrowClass}\n          onClick={this.toggleDropdown}\n        />\n        <MatchedNameList\n          matchedNames={matchedNames}\n          className={dropdownClass}\n          setDefaultMatchedName={this.setDefaultMatchedName}\n          isSelected={isSelected}\n          currentLocale={this.props.currentLocale}\n        />\n      </div>\n    );\n  }\n}\n\nRecipientHeader.propTypes = {\n  recipient: PropTypes.shape({\n    phoneNumber: PropTypes.string,\n    extensionNumber: PropTypes.string,\n    name: PropTypes.string,\n    matchedNames: PropTypes.array,\n  }).isRequired,\n  currentLocale: PropTypes.string.isRequired,\n  dropdownClassName: PropTypes.string.isRequired,\n};\n\nRecipientHeader.contextTypes = {\n  getRecipientName: PropTypes.func.isRequired,\n  getMatcherContactList: PropTypes.func.isRequired,\n  getMatcherContactNameList: PropTypes.func.isRequired,\n  changeMatchedNames: PropTypes.func.isRequired,\n};\n\nexport default RecipientHeader;\n"]}