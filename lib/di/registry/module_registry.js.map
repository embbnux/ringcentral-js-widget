{"version":3,"sources":["lib/di/registry/module_registry.js"],"names":["ModuleRegistry","_map","moduleRef","has","name","get","metadata","resolved","set","entries","keys","clear"],"mappings":";;;;;;;;;;;;;;;;;;;AAAA;;;;AAEA;;;IAGqBA,c;AACnB,4BAAc;AAAA;;AACZ;AACA,SAAKC,IAAL,GAAY,mBAAZ;AACD;;;;wBAEGC,S,EAAW;AACb,UAAI,CAAC,KAAKD,IAAL,CAAUE,GAAV,CAAcD,SAAd,CAAL,EAA+B;AAC7B,cAAM,6CAA+BA,UAAUE,IAAzC,yBAAN;AACD;AACD,aAAO,KAAKH,IAAL,CAAUI,GAAV,CAAcH,SAAd,EAAyBI,QAAhC;AACD;;;6BAEQJ,S,EAAW;AAClB,aAAO,KAAKD,IAAL,CAAUI,GAAV,CAAcH,SAAd,EAAyBK,QAAhC;AACD;;;wBAEGL,S,EAAWI,Q,EAAU;AACvB,UAAI,KAAKL,IAAL,CAAUE,GAAV,CAAcD,SAAd,CAAJ,EAA8B;AAC5B,cAAM,mDAAqCA,UAAUE,IAA/C,YAAN;AACD;AACD,aAAO,KAAKH,IAAL,CAAUO,GAAV,CAAcN,SAAd,EAAyB,EAAEI,kBAAF,EAAYC,UAAU,KAAtB,EAAzB,CAAP;AACD;;;4BAEOL,S,EAAWI,Q,EAAU;AAC3B,UAAI,CAAC,KAAKL,IAAL,CAAUE,GAAV,CAAcD,SAAd,CAAL,EAA+B;AAC7B,cAAM,yDAA2CA,SAA3C,4BAAN;AACD;AACD,WAAKD,IAAL,CAAUO,GAAV,CAAcN,SAAd,EAAyB;AACvBI,0BADuB;AAEvBC,kBAAU;AAFa,OAAzB;AAID;;;wBAEGL,S,EAAW;AACb,aAAO,KAAKD,IAAL,CAAUE,GAAV,CAAcD,SAAd,CAAP;AACD;;;8BAES;AACR,aAAO,KAAKD,IAAL,CAAUQ,OAAV,EAAP;AACD;;;2BAEM;AACL,aAAO,KAAKR,IAAL,CAAUS,IAAV,EAAP;AACD;;;4BAEO;AACN,WAAKT,IAAL,CAAUU,KAAV;AACD;;;;;kBAhDkBX,c","file":"module_registry.js","sourcesContent":["import { DIError } from '../utils/error';\n\n/**\n * Module registry is used to store module metadata.\n */\nexport default class ModuleRegistry {\n  constructor() {\n    // class reference -> metadata\n    this._map = new Map();\n  }\n\n  get(moduleRef) {\n    if (!this._map.has(moduleRef)) {\n      throw DIError(`Cannot find module [${moduleRef.name}] in ModuleRegistry`);\n    }\n    return this._map.get(moduleRef).metadata;\n  }\n\n  resolved(moduleRef) {\n    return this._map.get(moduleRef).resolved;\n  }\n\n  set(moduleRef, metadata) {\n    if (this._map.has(moduleRef)) {\n      throw DIError(`Can only register module [${moduleRef.name}] once`);\n    }\n    return this._map.set(moduleRef, { metadata, resolved: false });\n  }\n\n  resolve(moduleRef, metadata) {\n    if (!this._map.has(moduleRef)) {\n      throw DIError(`Cannot resolve module metadata [${moduleRef}]: module is not found`);\n    }\n    this._map.set(moduleRef, {\n      metadata,\n      resolved: true\n    });\n  }\n\n  has(moduleRef) {\n    return this._map.has(moduleRef);\n  }\n\n  entries() {\n    return this._map.entries();\n  }\n\n  keys() {\n    return this._map.keys();\n  }\n\n  reset() {\n    this._map.clear();\n  }\n}\n"]}