{"version":3,"sources":["lib/chunkMessage.js"],"names":["chunkMessage","text","maxLength","Error","chunks","fromIndex","total","length","toIndex","offset","char","charAt","isWhiteSpace","test","snippet","substring","push"],"mappings":";;;;;kBAMwBA,Y;AANxB;;;;;;AAMe,SAASA,YAAT,CAAsBC,IAAtB,EAA4BC,SAA5B,EAAuC;AACpD,MAAI,CAACD,IAAL,EAAW;AACT,WAAO,EAAP;AACD;;AAED,MAAI,OAAQC,SAAR,KAAuB,QAA3B,EAAqC;AACnC,UAAM,IAAIC,KAAJ,CAAU,iCAAV,CAAN;AACD;;AAED,MAAID,YAAY,CAAhB,EAAmB;AACjB,UAAM,IAAIC,KAAJ,CAAU,mCAAV,CAAN;AACD;;AAED,MAAMC,SAAS,EAAf;AACA,MAAIC,YAAY,CAAhB;AACA,MAAMC,QAAQL,KAAKM,MAAnB;;AAEA,SAAOF,YAAYC,KAAnB,EAA0B;AACxB,QAAIE,UAAUH,YAAYH,SAA1B;AACA,QAAIO,SAAS,CAAb;AACA,WAAOA,SAASP,SAAhB,EAA2BO,UAAU,CAArC,EAAwC;AACtC,UAAMC,OAAOT,KAAKU,MAAL,CAAYH,UAAUC,MAAtB,CAAb;AACA,UAAI,CAACC,IAAL,EAAW;AACT;AACD;AACD,UAAME,eAAe,KAAKC,IAAL,CAAUH,IAAV,CAArB;AACA,UAAIE,YAAJ,EAAkB;AAChB,YAAIH,SAAS,CAAb,EAAgB;AACdA,oBAAU,CAAV;AACD;AACD;AACD;AACF;AACD,QAAIA,WAAWP,SAAf,EAA0B;AACxBM,iBAAWC,MAAX;AACD;AACD,QAAMK,UAAUb,KAAKc,SAAL,CAAeV,SAAf,EAA0BG,OAA1B,CAAhB;AACAH,gBAAYG,OAAZ;AACAJ,WAAOY,IAAP,CAAYF,OAAZ;AACD;;AAED,SAAOV,MAAP;AACD","file":"chunkMessage.js","sourcesContent":["/**\n * this module seems better\n * https://www.npmjs.com/package/chunk-text\n * use our own implementation for now.\n */\n\nexport default function chunkMessage(text, maxLength) {\n  if (!text) {\n    return [];\n  }\n\n  if (typeof (maxLength) !== 'number') {\n    throw new Error('Should be a integer \"maxLength\"');\n  }\n\n  if (maxLength < 1) {\n    throw new Error('Should greater than 0 \"maxLength\"');\n  }\n\n  const chunks = [];\n  let fromIndex = 0;\n  const total = text.length;\n\n  while (fromIndex < total) {\n    let toIndex = fromIndex + maxLength;\n    let offset = 0;\n    for (; offset < maxLength; offset += 1) {\n      const char = text.charAt(toIndex - offset);\n      if (!char) {\n        break;\n      }\n      const isWhiteSpace = /\\s/.test(char);\n      if (isWhiteSpace) {\n        if (offset > 0) {\n          offset -= 1;\n        }\n        break;\n      }\n    }\n    if (offset !== maxLength) {\n      toIndex -= offset;\n    }\n    const snippet = text.substring(fromIndex, toIndex);\n    fromIndex = toIndex;\n    chunks.push(snippet);\n  }\n\n  return chunks;\n}\n"]}