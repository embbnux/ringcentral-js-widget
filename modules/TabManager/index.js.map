{"version":3,"sources":["modules/TabManager/index.js"],"names":["TabManager","options","actionTypes","_tabbie","Tabbie","prefix","_reducer","store","initSuccess","checkIsMain","type","active","dispatch","enabled","on","mainTabId","mainTabIdChanged","event","args","send","state","status","moduleStatuses","ready","RcModule"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;AACA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;AAEA;;;;IAKqBA,U,WADpB,iB;;;AAEC,4BAEG;AAAA,QADEC,OACF;AAAA;;AAAA,yKAEIA,OAFJ;AAGCC;AAHD;;AAKD,UAAKC,OAAL,GAAe,IAAIC,gBAAJ,CAAW;AACxBC,cAAQ,MAAKA;AADW,KAAX,CAAf;AAGA,UAAKC,QAAL,GAAgB,oCAAqB,MAAKJ,WAA1B,CAAhB;AARC;AASF;;;;;;;;;;;;+BAEC,KAAKK,K;+BACG,KAAKL,WAAL,CAAiBM,W;;uBACT,KAAKL,OAAL,CAAaM,WAAb,E;;;;;AADdC,sB;AACAC,wB;;;6BAFSC,Q;;AAIX,oBAAI,KAAKT,OAAL,CAAaU,OAAjB,EAA0B;AACxB,uBAAKV,OAAL,CAAaW,EAAb,CAAgB,kBAAhB;AAAA,yGAAoC,iBAAOC,SAAP;AAAA;AAAA;AAAA;AAAA;AAAA,4CAClC,OAAKR,KAD6B;AAAA,4CAE1B,OAAKL,WAAL,CAAiBc,gBAFS;AAAA,4CAGhCD,SAHgC;AAAA;AAAA,qCAIlB,OAAKZ,OAAL,CAAaM,WAAb,EAJkB;;AAAA;AAAA;AAAA;AAEhCC,oCAFgC;AAGhCK,yCAHgC;AAIhCJ,sCAJgC;AAAA;;AAAA,0CACvBC,QADuB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAApC;;AAAA;AAAA;AAAA;AAAA;AAOA,uBAAKT,OAAL,CAAaW,EAAb,CAAgB,OAAhB,EAAyB,UAACG,KAAD,EAAoB;AAAA,sDAATC,IAAS;AAATA,0BAAS;AAAA;;AAC3C,2BAAKX,KAAL,CAAWK,QAAX,CAAoB;AAClBF,4BAAM,OAAKR,WAAL,CAAiBe,KADL;AAElBA,kCAFkB;AAGlBC;AAHkB,qBAApB;AAKD,mBAND;AAOD;;;;;;;;;;;;;;;;;;yBAGED,K,EAAgB;AAAA;;AAAA,yCAANC,IAAM;AAANA,YAAM;AAAA;;AACnB,sBAAKf,OAAL,EAAagB,IAAb,iBAAkBF,KAAlB,SAA4BC,IAA5B;AACD;;;;;;;;;kDAeQ,KAAKf,OAAL,CAAaM,WAAb,E;;;;;;;;;;;;;;;;;;wBAbI;AACX,aAAO,KAAKW,KAAL,CAAWC,MAAlB;AACD;;;wBAEW;AACV,aAAO,KAAKD,KAAL,CAAWC,MAAX,KAAsBC,yBAAeC,KAA5C;AACD;;;wBAEY;AACX,aAAO,KAAKH,KAAL,CAAWT,MAAlB;AACD;;;wBAMW;AACV,aAAO,KAAKS,KAAL,CAAWH,KAAlB;AACD;;;EA1DqCO,kB;kBAAnBxB,U","file":"index.js","sourcesContent":["import RcModule from '../../lib/RcModule';\nimport { Module } from '../../lib/di';\nimport Tabbie from '../../lib/Tabbie';\nimport moduleStatuses from '../../enums/moduleStatuses';\nimport actionTypes from './actionTypes';\nimport getTabManagerReducer from './getTabManagerReducer';\n\n/**\n * @class\n * @description To handle data between different tabs\n */\n@Module()\nexport default class TabManager extends RcModule {\n  constructor({\n    ...options\n  }) {\n    super({\n      ...options,\n      actionTypes,\n    });\n    this._tabbie = new Tabbie({\n      prefix: this.prefix,\n    });\n    this._reducer = getTabManagerReducer(this.actionTypes);\n  }\n  async initialize() {\n    this.store.dispatch({\n      type: this.actionTypes.initSuccess,\n      active: await this._tabbie.checkIsMain(),\n    });\n    if (this._tabbie.enabled) {\n      this._tabbie.on('mainTabIdChanged', async (mainTabId) => {\n        this.store.dispatch({\n          type: this.actionTypes.mainTabIdChanged,\n          mainTabId,\n          active: await this._tabbie.checkIsMain(),\n        });\n      });\n      this._tabbie.on('event', (event, ...args) => {\n        this.store.dispatch({\n          type: this.actionTypes.event,\n          event,\n          args,\n        });\n      });\n    }\n  }\n\n  send(event, ...args) {\n    this._tabbie.send(event, ...args);\n  }\n\n  get status() {\n    return this.state.status;\n  }\n\n  get ready() {\n    return this.state.status === moduleStatuses.ready;\n  }\n\n  get active() {\n    return this.state.active;\n  }\n\n  async ensureActive() {\n    return this._tabbie.checkIsMain();\n  }\n\n  get event() {\n    return this.state.event;\n  }\n}\n"]}