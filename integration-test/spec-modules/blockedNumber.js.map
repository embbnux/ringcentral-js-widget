{"version":3,"sources":["integration-test/spec-modules/blockedNumber.js"],"names":["mock","authzProfileBody","require","auth","client","blockedNumber","account","describe","timeout","mockClient","isLoginSuccess","clientHistoryRequest","ClientHistoryRequest","afterEach","logout","it","restore","mockForLogin","console","error","skip","retries","expect","numbers","length","equal","mockAuthzProfile","authzProfile","permissions","filter","p","permission","id"],"mappings":";;;;;;;;;;;;;;;;;;AAAA;;AACA;;AACA;;;;AACA;;IAAYA,I;;;;;;AAEZ,IAAMC,mBAAmBC,QAAQ,2BAAR,CAAzB;;kBAEe,UAACC,IAAD,EAAOC,MAAP,EAAeC,aAAf,EAA8BC,OAA9B,EAA0C;AACvDC,WAAS,gBAAT,EAA2B,YAAY;AAAA;;AACrC,SAAKC,OAAL,CAAa,KAAb;AACAR,SAAKS,UAAL,CAAgBL,MAAhB;;AAEA,QAAIM,uBAAJ;AACA,QAAMC,uBAAuB,IAAIC,8BAAJ,CAAyB,mBAAzB,EAAoCR,MAApC,CAA7B;;AAEAS,uFAAU;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBACFV,KAAKW,MAAL,EADE;;AAAA;AAAA;AAAA,qBAEF,6BAAc,CAAd,CAFE;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAV;;AAKAC,OAAG,iEAAH,2EAAsE;AAAA;AAAA;AAAA;AAAA;AACpEf,mBAAKgB,OAAL;AACAhB,mBAAKiB,YAAL;AAFoE;AAAA,qBAG7C,2BAAYd,IAAZ,EAAkBG,OAAlB,CAH6C;;AAAA;AAGpEI,4BAHoE;;AAIpE,kBAAI,CAACA,cAAL,EAAqB;AACnBQ,wBAAQC,KAAR,CAAc,oDAAd,EAAoEb,OAApE;AACA,sBAAKc,IAAL;AACD;AACD,oBAAKC,OAAL,CAAa,CAAb;AARoE;AAAA,qBAS9D,6BAAc,CAAd,CAT8D;;AAAA;AAUpEC,qBAAOjB,cAAckB,OAAd,CAAsBC,MAA7B,EAAqCC,KAArC,CAA2C,CAA3C;;AAVoE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAtE;;AAaAV,OAAG,wEAAH,2EAA6E;AAAA;AAAA;AAAA;AAAA;AAC3Ef,mBAAKgB,OAAL;AACAhB,mBAAKiB,YAAL,CAAkB,EAAES,kBAAkB,KAApB,EAAlB;AACA1B,mBAAK2B,YAAL,CAAkB;AAChBC,6BAAa3B,iBAAiB2B,WAAjB,CAA6BC,MAA7B,CAAoC;AAAA,yBAAKC,EAAEC,UAAF,CAAaC,EAAb,KAAoB,oBAAzB;AAAA,iBAApC;AADG,eAAlB;AAH2E;AAAA,qBAMpD,2BAAY7B,IAAZ,EAAkBG,OAAlB,CANoD;;AAAA;AAM3EI,4BAN2E;;AAO3E,kBAAI,CAACA,cAAL,EAAqB;AACnBQ,wBAAQC,KAAR,CAAc,oDAAd,EAAoEb,OAApE;AACA,sBAAKc,IAAL;AACD;AACD,oBAAKC,OAAL,CAAa,CAAb;AAX2E;AAAA,qBAYrE,6BAAc,CAAd,CAZqE;;AAAA;AAa3EC,qBAAOjB,cAAckB,OAAd,CAAsBC,MAA7B,EAAqCC,KAArC,CAA2C,CAA3C;;AAb2E;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAA7E;AAeD,GAxCD;AAyCD,C","file":"blockedNumber.js","sourcesContent":["import { ensureLogin } from '../utils/HelpUtil';\nimport { waitInSeconds } from '../utils/WaitUtil';\nimport ClientHistoryRequest from '../utils/ClientHistoryRequest';\nimport * as mock from '../mock';\n\nconst authzProfileBody = require('../mock/data/authzProfile');\n\nexport default (auth, client, blockedNumber, account) => {\n  describe('BlockedNumber:', function () {\n    this.timeout(20000);\n    mock.mockClient(client);\n\n    let isLoginSuccess;\n    const clientHistoryRequest = new ClientHistoryRequest(new Map(), client);\n\n    afterEach(async function () {\n      await auth.logout();\n      await waitInSeconds(1);\n    });\n\n    it('Should load numbers when there is ReadBlockedNumbers permission', async () => {\n      mock.restore();\n      mock.mockForLogin();\n      isLoginSuccess = await ensureLogin(auth, account);\n      if (!isLoginSuccess) {\n        console.error('Skip test case as failed to login with credential ', account);\n        this.skip();\n      }\n      this.retries(2);\n      await waitInSeconds(1);\n      expect(blockedNumber.numbers.length).equal(1);\n    });\n\n    it(\"Should not load numbers when there isn't ReadBlockedNumbers permission\", async () => {\n      mock.restore();\n      mock.mockForLogin({ mockAuthzProfile: false });\n      mock.authzProfile({\n        permissions: authzProfileBody.permissions.filter(p => p.permission.id !== 'ReadBlockedNumbers')\n      });\n      isLoginSuccess = await ensureLogin(auth, account);\n      if (!isLoginSuccess) {\n        console.error('Skip test case as failed to login with credential ', account);\n        this.skip();\n      }\n      this.retries(2);\n      await waitInSeconds(1);\n      expect(blockedNumber.numbers.length).equal(0);\n    });\n  });\n};\n"]}