{"version":3,"sources":["containers/CallCtrlPage/CallCtrlContainer.js"],"names":["CallCtrlContainer","props","layout","getInitialLayout","disableMergeAndAdd","mergeDisabled","addDisabled","state","selectedMatcherIndex","avatarUrl","onLastMergingCallEnded","onSelectMatcherName","option","nameMatches","findIndex","match","id","setState","contact","updateSessionMatchedContact","session","getAvatarUrl","then","onMute","onUnmute","onHold","onUnhold","onRecord","onStopRecord","onHangup","onKeyPadChange","sendDTMF","value","onFlip","onTransfer","onPark","onAdd","onMerge","onBeforeMerge","gotoParticipantsCtrl","_mounted","_updateAvatarAndMatchIndex","_updateCurrentConferenceCall","_updateMergingPairToSessionId","isLastCallEnded","nextProps","lastCallInfo","isWebRTC","isConferenceCallOverload","hasConferenceCall","isInboundCall","direction","callDirections","inbound","isMergeAndAddDisabled","partyData","callCtrlLayouts","mergeCtrl","status","sessionStatus","finished","normalCtrl","closeMergingPair","lastProps","showSpinner","conferenceCtrl","nextState","getLayout","conferenceCallParties","_updateMergeAddButtonDisabled","contactMatch","loadConference","conferenceCallId","setMergeParty","toSessionId","phoneNumber","outbound","to","from","fallbackUserName","i18n","getString","currentLocale","backButtonLabel","formatPhone","callStatus","startTime","isOnMute","isOnHold","isOnFlip","isOnTransfer","recordStatus","showBackButton","onBackButtonClick","areaCode","countryCode","brand","showContactDisplayPlaceholder","flipNumbers","sourceIcons","searchContactList","searchContact","phoneTypeRenderer","phoneSourceNameRenderer","recipientsContactInfoRenderer","recipientsContactPhoneRenderer","conferenceCallEquipped","afterHideMergeConfirm","afterConfirmMerge","afterOnMerge","children","Component","propTypes","PropTypes","shape","string","number","bool","object","isRequired","func","node","array","defaultProps","undefined","calleeType","calleeTypes","unknow","i"],"mappings":"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","file":"CallCtrlContainer.js","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport sleep from 'ringcentral-integration/lib/sleep';\nimport calleeTypes from 'ringcentral-integration/enums/calleeTypes';\nimport callDirections from 'ringcentral-integration/enums/callDirections';\nimport sessionStatus from 'ringcentral-integration/modules/Webphone/sessionStatus';\nimport callCtrlLayouts from '../../enums/callCtrlLayouts';\nimport CallCtrlPanel from '../../components/CallCtrlPanel';\nimport i18n from './i18n';\n\nclass CallCtrlContainer extends Component {\n  constructor(props) {\n    super(props);\n    const layout = props.getInitialLayout(this.props);\n    const { mergeDisabled, addDisabled } = this.disableMergeAndAdd(this.props, layout);\n    this.state = {\n      selectedMatcherIndex: 0,\n      avatarUrl: null,\n      layout,\n      mergeDisabled,\n      addDisabled,\n    };\n\n    this.onLastMergingCallEnded = this:: this.onLastMergingCallEnded;\n\n    this.onSelectMatcherName = (option) => {\n      const nameMatches = this.props.nameMatches || [];\n      let selectedMatcherIndex = nameMatches.findIndex(\n        match => match.id === option.id\n      );\n      if (selectedMatcherIndex < 0) {\n        selectedMatcherIndex = 0;\n      }\n      this.setState({\n        selectedMatcherIndex,\n        avatarUrl: null,\n      });\n      const contact = nameMatches[selectedMatcherIndex];\n      if (contact) {\n        this.props.updateSessionMatchedContact(this.props.session.id, contact);\n        this.props.getAvatarUrl(contact).then((avatarUrl) => {\n          this.setState({ avatarUrl });\n        });\n      }\n    };\n\n    this.onMute = () =>\n      this.props.onMute(this.props.session.id);\n    this.onUnmute = () =>\n      this.props.onUnmute(this.props.session.id);\n    this.onHold = () =>\n      this.props.onHold(this.props.session.id);\n    this.onUnhold = () =>\n      this.props.onUnhold(this.props.session.id);\n    this.onRecord = () =>\n      this.props.onRecord(this.props.session.id);\n    this.onStopRecord = () =>\n      this.props.onStopRecord(this.props.session.id);\n    this.onHangup = () =>\n      this.props.onHangup(this.props.session.id, this.state.layout);\n    this.onKeyPadChange = value =>\n      this.props.sendDTMF(value, this.props.session.id);\n    this.onFlip = value =>\n      this.props.onFlip(value, this.props.session.id);\n    this.onTransfer = value =>\n      this.props.onTransfer(value, this.props.session.id);\n    this.onPark = () =>\n      this.props.onPark(this.props.session.id);\n    this.onAdd = () =>\n      this.props.onAdd(this.props.session.id);\n    this.onMerge = () =>\n      this.props.onMerge(this.props.session.id);\n    this.onBeforeMerge = () =>\n      this.props.onBeforeMerge(this.props.session.id);\n    this.gotoParticipantsCtrl = () =>\n      this.props.gotoParticipantsCtrl(this.props.session.id);\n  }\n\n  static isLastCallEnded({ lastCallInfo }) {\n    return !!(\n      lastCallInfo && lastCallInfo.status === sessionStatus.finished\n    );\n  }\n\n  componentDidMount() {\n    this._mounted = true;\n    this._updateAvatarAndMatchIndex(this.props);\n    this._updateCurrentConferenceCall(this.props);\n    this._updateMergingPairToSessionId();\n\n    if (CallCtrlContainer.isLastCallEnded(this.props)) {\n      /**\n       * if the last has already been terminated after rendering, need to trigger the callback at the point\n       */\n      this.onLastMergingCallEnded();\n    }\n  }\n\n  disableMergeAndAdd(nextProps, layout) {\n    const {\n      lastCallInfo,\n      isWebRTC,\n      isConferenceCallOverload,\n      session,\n      hasConferenceCall,\n    } = nextProps;\n\n    const isInboundCall = session.direction === callDirections.inbound;\n    const isMergeAndAddDisabled = !isWebRTC || isInboundCall || !session.partyData;\n\n    let mergeDisabled = isMergeAndAddDisabled;\n    let addDisabled = isMergeAndAddDisabled;\n    if (\n      layout === callCtrlLayouts.mergeCtrl\n      && (!lastCallInfo || lastCallInfo.status === sessionStatus.finished)\n    ) {\n      mergeDisabled = true;\n    }\n\n    if (hasConferenceCall && isWebRTC && isConferenceCallOverload) {\n      mergeDisabled = true;\n      addDisabled = true;\n    }\n\n    return { mergeDisabled, addDisabled };\n  }\n\n  async onLastMergingCallEnded() {\n    if (this._mounted) {\n      await sleep(2000);\n\n      if (this._mounted) {\n        this.setState({\n          layout: callCtrlLayouts.normalCtrl\n        });\n      }\n\n      if (this.props.closeMergingPair) {\n        this.props.closeMergingPair();\n      }\n    }\n  }\n\n  getLayout(lastProps, nextProps) {\n    if (nextProps.showSpinner) {\n      return callCtrlLayouts.conferenceCtrl;\n    }\n    return this.props.getInitialLayout(nextProps);\n  }\n\n  componentWillReceiveProps(nextProps, nextState) {\n    this._updateMergingPairToSessionId(nextProps, nextState);\n\n    let layout = this.state.layout;\n    if (nextProps.session.id !== this.props.session.id) {\n      layout = this.getLayout(this.props, nextProps);\n      this.setState({\n        layout,\n      });\n\n      if (\n        layout === callCtrlLayouts.normalCtrl\n      ) {\n        this._updateAvatarAndMatchIndex(nextProps);\n      }\n    } else if (\n      layout === callCtrlLayouts.mergeCtrl\n      && CallCtrlContainer.isLastCallEnded(this.props) === false\n      && CallCtrlContainer.isLastCallEnded(nextProps) === true\n    ) {\n      this.onLastMergingCallEnded();\n    } else if (layout === callCtrlLayouts.conferenceCtrl &&\n      this.props.conferenceCallParties !== nextProps.conferenceCallParties) {\n      this._updateCurrentConferenceCall(nextProps);\n    }\n    this._updateMergeAddButtonDisabled(nextProps, layout);\n  }\n\n  _updateMergeAddButtonDisabled(nextProps, layout) {\n    const { mergeDisabled, addDisabled } = this.disableMergeAndAdd(nextProps, layout);\n    this.setState({\n      mergeDisabled,\n      addDisabled\n    });\n  }\n\n  componentWillUnmount() {\n    this._mounted = false;\n  }\n\n  _updateAvatarAndMatchIndex(props) {\n    let contact = props.session.contactMatch;\n    let selectedMatcherIndex = 0;\n    if (!contact) {\n      contact = props.nameMatches && props.nameMatches[0];\n    } else {\n      selectedMatcherIndex = props.nameMatches.findIndex(match =>\n        match.id === contact.id\n      );\n    }\n    this.setState({\n      selectedMatcherIndex,\n      avatarUrl: null,\n    });\n    if (contact) {\n      props.getAvatarUrl(contact).then((avatarUrl) => {\n        if (!this._mounted) {\n          return;\n        }\n        this.setState({ avatarUrl });\n      });\n    }\n  }\n\n  _updateCurrentConferenceCall(props) {\n    if (\n      this.state.layout === callCtrlLayouts.conferenceCtrl\n      && props.loadConference\n    ) {\n      props.loadConference(props.conferenceCallId);\n    }\n  }\n\n  _updateMergingPairToSessionId(nextProps = this.props, nextState = this.state) {\n    if (\n      nextState.layout === callCtrlLayouts.mergeCtrl &&\n      nextProps.lastCallInfo\n    ) {\n      nextProps.setMergeParty({ toSessionId: nextProps.session.id });\n    }\n  }\n\n  render() {\n    const { session } = this.props;\n    if (!session.id) {\n      return null;\n    }\n\n    const phoneNumber = session.direction === callDirections.outbound ?\n      session.to : session.from;\n\n    let fallbackUserName;\n    if (session.direction === callDirections.inbound && session.from === 'anonymous') {\n      fallbackUserName = i18n.getString('anonymous', this.props.currentLocale);\n    }\n    if (!fallbackUserName) {\n      fallbackUserName = i18n.getString('unknown', this.props.currentLocale);\n    }\n\n    const backButtonLabel = this.props.backButtonLabel\n      ? this.props.backButtonLabel\n      : i18n.getString('activeCalls', this.props.currentLocale);\n\n    return (\n      <CallCtrlPanel\n        currentLocale={this.props.currentLocale}\n        formatPhone={this.props.formatPhone}\n        phoneNumber={phoneNumber}\n        sessionId={session.id}\n        callStatus={session.callStatus}\n        startTime={session.startTime}\n        isOnMute={session.isOnMute}\n        isOnHold={session.isOnHold}\n        isOnFlip={session.isOnFlip}\n        isOnTransfer={session.isOnTransfer}\n        recordStatus={session.recordStatus}\n        showBackButton={this.props.showBackButton}\n        backButtonLabel={backButtonLabel}\n        onBackButtonClick={this.props.onBackButtonClick}\n        onMute={this.onMute}\n        onUnmute={this.onUnmute}\n        onHold={this.onHold}\n        onUnhold={this.onUnhold}\n        onRecord={this.onRecord}\n        onStopRecord={this.onStopRecord}\n        onKeyPadChange={this.onKeyPadChange}\n        onHangup={this.onHangup}\n        onAdd={this.onAdd}\n        onMerge={this.onMerge}\n        onBeforeMerge={this.onBeforeMerge}\n        onFlip={this.onFlip}\n        onTransfer={this.onTransfer}\n        onPark={this.onPark}\n        nameMatches={this.props.nameMatches}\n        fallBackName={fallbackUserName}\n        areaCode={this.props.areaCode}\n        countryCode={this.props.countryCode}\n        selectedMatcherIndex={this.state.selectedMatcherIndex}\n        onSelectMatcherName={this.onSelectMatcherName}\n        avatarUrl={this.state.avatarUrl}\n        brand={this.props.brand}\n        showContactDisplayPlaceholder={this.props.showContactDisplayPlaceholder}\n        flipNumbers={this.props.flipNumbers}\n        sourceIcons={this.props.sourceIcons}\n        searchContactList={this.props.searchContactList}\n        searchContact={this.props.searchContact}\n        phoneTypeRenderer={this.props.phoneTypeRenderer}\n        phoneSourceNameRenderer={this.props.phoneSourceNameRenderer}\n        recipientsContactInfoRenderer={this.props.recipientsContactInfoRenderer}\n        recipientsContactPhoneRenderer={this.props.recipientsContactPhoneRenderer}\n        layout={this.state.layout}\n        showSpinner={this.props.showSpinner}\n        direction={session.direction}\n        addDisabled={this.state.addDisabled}\n        mergeDisabled={this.state.mergeDisabled}\n        conferenceCallEquipped={this.props.conferenceCallEquipped}\n        hasConferenceCall={this.props.hasConferenceCall}\n        conferenceCallParties={this.props.conferenceCallParties}\n        lastCallInfo={this.props.lastCallInfo}\n        getAvatarUrl={this.props.getAvatarUrl}\n        gotoParticipantsCtrl={this.gotoParticipantsCtrl}\n        afterHideMergeConfirm={this.props.afterHideMergeConfirm}\n        afterConfirmMerge={this.props.afterConfirmMerge}\n        afterOnMerge={this.props.afterOnMerge}\n      >\n        {this.props.children}\n      </CallCtrlPanel>\n    );\n  }\n}\n\nCallCtrlContainer.propTypes = {\n  session: PropTypes.shape({\n    id: PropTypes.string,\n    direction: PropTypes.string,\n    startTime: PropTypes.number,\n    isOnMute: PropTypes.bool,\n    isOnHold: PropTypes.bool,\n    isOnFlip: PropTypes.bool,\n    isOnTransfer: PropTypes.bool,\n    recordStatus: PropTypes.string,\n    to: PropTypes.string,\n    from: PropTypes.string,\n    contactMatch: PropTypes.object,\n  }).isRequired,\n  currentLocale: PropTypes.string.isRequired,\n  onMute: PropTypes.func.isRequired,\n  onUnmute: PropTypes.func.isRequired,\n  onHold: PropTypes.func.isRequired,\n  onUnhold: PropTypes.func.isRequired,\n  onRecord: PropTypes.func.isRequired,\n  onStopRecord: PropTypes.func.isRequired,\n  onHangup: PropTypes.func.isRequired,\n  sendDTMF: PropTypes.func.isRequired,\n  formatPhone: PropTypes.func.isRequired,\n  onAdd: PropTypes.func,\n  onMerge: PropTypes.func,\n  onBeforeMerge: PropTypes.func,\n  onFlip: PropTypes.func.isRequired,\n  onPark: PropTypes.func.isRequired,\n  onTransfer: PropTypes.func.isRequired,\n  children: PropTypes.node,\n  nameMatches: PropTypes.array.isRequired,\n  areaCode: PropTypes.string.isRequired,\n  countryCode: PropTypes.string.isRequired,\n  getAvatarUrl: PropTypes.func.isRequired,\n  updateSessionMatchedContact: PropTypes.func.isRequired,\n  showBackButton: PropTypes.bool,\n  backButtonLabel: PropTypes.string,\n  onBackButtonClick: PropTypes.func,\n  brand: PropTypes.string.isRequired,\n  showContactDisplayPlaceholder: PropTypes.bool.isRequired,\n  flipNumbers: PropTypes.array.isRequired,\n  sourceIcons: PropTypes.object,\n  searchContactList: PropTypes.array.isRequired,\n  searchContact: PropTypes.func.isRequired,\n  phoneTypeRenderer: PropTypes.func,\n  phoneSourceNameRenderer: PropTypes.func,\n  recipientsContactInfoRenderer: PropTypes.func,\n  recipientsContactPhoneRenderer: PropTypes.func,\n  layout: PropTypes.string,\n  showSpinner: PropTypes.bool,\n  conferenceCallParties: PropTypes.array,\n  conferenceCallEquipped: PropTypes.bool,\n  hasConferenceCall: PropTypes.bool,\n  lastCallInfo: PropTypes.object,\n  conferenceCallId: PropTypes.string,\n  gotoParticipantsCtrl: PropTypes.func,\n  loadConference: PropTypes.func,\n  getInitialLayout: PropTypes.func,\n  closeMergingPair: PropTypes.func,\n  isWebRTC: PropTypes.bool,\n  isConferenceCallOverload: PropTypes.bool,\n  afterHideMergeConfirm: PropTypes.func,\n  afterConfirmMerge: PropTypes.func,\n  afterOnMerge: PropTypes.func,\n};\n\nCallCtrlContainer.defaultProps = {\n  children: undefined,\n  showBackButton: false,\n  backButtonLabel: null,\n  onBackButtonClick: null,\n  sourceIcons: undefined,\n  phoneTypeRenderer: undefined,\n  phoneSourceNameRenderer: undefined,\n  recipientsContactInfoRenderer: undefined,\n  recipientsContactPhoneRenderer: undefined,\n  onAdd: undefined,\n  onMerge: undefined,\n  onBeforeMerge: undefined,\n  showSpinner: false,\n  conferenceCallEquipped: false,\n  hasConferenceCall: false,\n  conferenceCallParties: undefined,\n  lastCallInfo: { calleeType: calleeTypes.unknow },\n  conferenceCallId: null,\n  gotoParticipantsCtrl: i => i,\n  loadConference: i => i,\n  getInitialLayout: () => callCtrlLayouts.normalCtrl,\n  layout: callCtrlLayouts.normalCtrl,\n  closeMergingPair: null,\n  isWebRTC: false,\n  isConferenceCallOverload: false,\n  afterHideMergeConfirm: () => null,\n  afterConfirmMerge: () => null,\n  afterOnMerge: () => null,\n};\n\n\nexport default CallCtrlContainer;\n"]}